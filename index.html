<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13.0</title>
    <style>
        :root { --primary: #2271b1; --success: #28a745; --error: #dc3545; --bg: #f0f0f1; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: #3c434a; margin: 0; padding-bottom: 100px; }
        
        .header { position: fixed; top: 0; left: 0; right: 0; background: #fff; border-bottom: 1px solid #c3c4c7; padding: 15px 20px; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .logo { font-weight: 800; color: var(--primary); font-size: 1.2rem; }
        .timer-box { font-variant-numeric: tabular-nums; font-size: 1.4rem; font-weight: 700; color: #1d2327; background: #f0f0f1; padding: 5px 15px; border-radius: 4px; }
        
        .container { max-width: 800px; margin: 90px auto 20px; padding: 0 20px; }

        .card { background: #fff; border: 1px solid #c3c4c7; padding: 25px; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .q-text { font-size: 1.1rem; font-weight: 600; margin-bottom: 20px; color: #1d2327; line-height: 1.5; }
        
        .option-label { display: flex; align-items: flex-start; gap: 12px; padding: 12px; border: 2px solid #f0f0f1; border-radius: 6px; cursor: pointer; transition: all 0.2s; margin-bottom: 10px; font-size: 0.95rem; }
        .option-label:hover { background: #f6f7f7; border-color: var(--primary); }
        .option-label input { margin-top: 3px; transform: scale(1.3); cursor: pointer; flex-shrink: 0; accent-color: var(--primary); }
        
        .fab-finish { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #d63638; color: white; padding: 15px 40px; border-radius: 50px; border: none; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(214, 54, 56, 0.4); z-index: 999; transition: transform 0.2s; white-space: nowrap; }
        .fab-finish:hover { transform: translateX(-50%) scale(1.05); background: #b32d2e; }

        /* MODAL RESULTADOS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 800px; max-height: 90vh; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        
        .modal-header { padding: 20px; background: #f9f9f9; border-bottom: 1px solid #eee; text-align: center; }
        .score-big { font-size: 2.5rem; font-weight: 800; margin: 10px 0; color: var(--primary); }
        .verdict { font-size: 1.5rem; font-weight: 700; text-transform: uppercase; margin-bottom: 10px; }
        
        .modal-body { padding: 20px; overflow-y: auto; flex-grow: 1; text-align: left; background: #f0f0f1; }
        
        .btn-restart { background: var(--primary); color: white; border: none; padding: 15px; font-size: 1.1rem; cursor: pointer; width: 100%; font-weight: bold; }
        .btn-restart:hover { background: #135e96; }

        /* REVISI√ìN DETALLADA */
        .review-item { background: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 5px solid #ccc; font-size: 0.95rem; }
        .review-item.r-correct { border-left-color: var(--success); background: #f4fff7; }
        .review-item.r-wrong { border-left-color: var(--error); background: #fff5f5; }
        
        .r-question { font-weight: bold; margin-bottom: 10px; display: block; color: #333; }
        .r-user-ans { display: block; margin-bottom: 5px; }
        .r-correct-ans { display: block; margin-bottom: 5px; color: var(--success); font-weight: 600; }
        .r-explanation { display: block; margin-top: 10px; font-style: italic; color: #666; font-size: 0.9rem; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 5px; }

        .tag-correct { color: var(--success); font-weight: bold; }
        .tag-wrong { color: var(--error); font-weight: bold; text-decoration: line-through; }

        .progress-container { position: fixed; top: 69px; left: 0; width: 100%; height: 4px; background: #e0e0e0; z-index: 998; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }

        .explanation-box { display: none; margin-top: 15px; padding: 12px; background: #f9f9f9; border-left: 4px solid #ccc; border-radius: 4px; font-size: 0.9rem; color: #555; }
        .correct-card .explanation-box { border-left-color: var(--success); background: #f4fff7; }
        .wrong-card .explanation-box { border-left-color: var(--error); background: #fff5f5; }
        .correct-answer { background: #d4edda !important; border-color: var(--success) !important; }
        .user-wrong { background: #f8d7da !important; border-color: var(--error) !important; }
        .options-group { display: flex; flex-direction: column; }
    </style>
</head>
<body>

    <div id="result-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin:0;">RESULTADO</h2>
                <div id="score-display" class="score-big">0 / 50</div>
                <div id="verdict-text" class="verdict">...</div>
                <div style="font-size:0.9rem; color:#666;">
                    ‚úÖ <span id="res-correct">0</span> | 
                    ‚ùå <span id="res-wrong">0</span>
                </div>
            </div>
            <div class="modal-body" id="detailed-review"></div>
            <button class="btn-restart" onclick="location.reload()">REPETIR EXAMEN</button>
        </div>
    </div>

    <header class="header">
        <div class="logo">EXAMEN WP AVANZADO</div>
        <div class="timer-box" id="timer">45:00</div>
    </header>
    <div class="progress-container"><div class="progress-bar" id="progress"></div></div>

    <div class="container" id="quiz-container"></div>

    <button class="fab-finish" onclick="finishExam()">FINALIZAR Y CALIFICAR</button>

<script>
const DB = [
        { q: "¬øEn qu√© archivo exacto se guardan los datos de conexi√≥n a la base de datos (Nombre, Usuario, Contrase√±a)?", o: ["En el archivo functions.php del tema activo", "En el archivo wp-config.php de la ra√≠z", "En el archivo database.php del servidor", "En el archivo wp-admin.php del n√∫cleo"], a: 1, e: "wp-config.php es vital: contiene las constantes DB_NAME, DB_USER y DB_PASSWORD." },
        { q: "¬øQu√© prefijo de tablas se recomienda usar por seguridad durante la instalaci√≥n de WordPress?", o: ["Mantener 'wp_' por compatibilidad con plugins", "Usar 'admin_' para recordar que es nuestro", "Cambiar 'wp_' por algo aleatorio (ej: x7z_)", "Usar 'db_' para indicar base de datos"], a: 2, e: "Cambiar 'wp_' dificulta los ataques automatizados de inyecci√≥n SQL a tablas por defecto." },
        { q: "¬øCu√°l es la configuraci√≥n de Enlaces Permanentes recomendada para mejorar el SEO?", o: ["Simple (midominio.com/?p=123)", "Nombre de la entrada (midominio.com/titulo-post)", "Num√©rico (midominio.com/archivos/123)", "D√≠a y nombre (midominio.com/2023/10/25/post)"], a: 1, e: "Ayuda a Google y a los usuarios a entender el contenido de la p√°gina solo leyendo la URL." },
        { q: "¬øQu√© archivo maneja las redirecciones del servidor y la configuraci√≥n de Apache?", o: [".htaccess", "robots.txt", "config.php", "sitemap.xml"], a: 0, e: "El archivo .htaccess controla c√≥mo el servidor procesa las URLs antes de cargar WordPress." },
        { q: "Para cumplir el RGPD, ¬øc√≥mo debe configurarse la casilla de aceptaci√≥n en los formularios?", o: ["Marcada por defecto para facilitar el env√≠o", "Oculta pero aceptada internamente", "Desmarcada y siendo obligatoria su marcaci√≥n", "Visible pero opcional para el usuario"], a: 2, e: "La ley exige una acci√≥n afirmativa clara (consentimiento expreso) del usuario." },
        { q: "¬øCu√°l es el peso m√°ximo ideal recomendado por imagen para no perjudicar el WPO?", o: ["Menos de 2 MB", "Entre 500 KB y 1 MB", "Menos de 200 KB aprox", "No importa si usas Lazy Load"], a: 2, e: "Mantener las im√°genes ligeras es la regla de oro para una carga r√°pida." },
        { q: "En Elementor, ¬øqu√© es un 'Loop Item' dentro del Theme Builder?", o: ["Una p√°gina de archivo completa", "El dise√±o de una tarjeta individual que se repite", "Un widget de carrusel de im√°genes", "El pie de p√°gina global"], a: 1, e: "Dise√±as una sola tarjeta (Loop Item) y se usa como plantilla para cada post en la rejilla." },
        { q: "Si dos cabeceras 'sticky' se solapan, ¬øqu√© propiedad soluciona el conflicto?", o: ["Z-Index (√çndice de profundidad)", "Offset (Desplazamiento)", "Padding (Relleno interno)", "Margin (Margen externo)"], a: 1, e: "El Offset determina a qu√© distancia del borde superior se activa o detiene el elemento." },
        { q: "¬øQu√© tipo de producto usar√≠as para vender un pack de 3 productos existentes juntos?", o: ["Producto Variable", "Producto Simple", "Producto Agrupado", "Producto Externo"], a: 2, e: "Permite mostrar varios productos simples en una misma ficha padre sin crear uno nuevo." },
        { q: "¬øQu√© plugin es el est√°ndar mencionado para realizar copias de seguridad y migraciones?", o: ["Jetpack Security", "All-in-One WP Migration", "WooCommerce Backup", "Elementor Tools"], a: 1, e: "Empaqueta toda la web (archivos + base de datos) en un solo archivo descargable." },
        { q: "¬øCu√°l es la funci√≥n principal del sistema 'Lazy Load'?", o: ["Comprimir las im√°genes al subirlas", "Cargar im√°genes solo cuando son visibles al hacer scroll", "Hacer que la web cargue todos los recursos al inicio", "Eliminar las im√°genes en dispositivos m√≥viles"], a: 1, e: "Mejora la velocidad inicial al diferir la carga de recursos que no est√°n en pantalla." },
        { q: "¬øPara qu√© sirve crear un Custom Post Type (CPT)?", o: ["Para crear entradas de blog normales", "Para gestionar contenidos espec√≠ficos (ej: Inmuebles, Proyectos)", "Para cambiar el dise√±o del tema", "Para instalar plugins"], a: 1, e: "Separa contenidos sem√°nticamente distintos de las Entradas y P√°ginas est√°ndar." },
        { q: "¬øQu√© funci√≥n cumple el archivo robots.txt?", o: ["Guardar las contrase√±as de la base de datos", "Dar instrucciones de rastreo a los bots de b√∫squeda", "Configurar el dise√±o de la web", "Gestionar los comentarios de spam"], a: 1, e: "Indica a Google qu√© partes de la web tiene permitido o prohibido rastrear." },
        { q: "¬øQu√© rol de usuario tiene acceso total a todas las funciones del sistema?", o: ["Editor", "Autor", "Administrador", "Colaborador"], a: 2, e: "Es el √∫nico que puede instalar plugins, cambiar temas y gestionar usuarios." },
        { q: "¬øCu√°l es la diferencia principal entre Entradas y P√°ginas?", o: ["No hay diferencia t√©cnica", "Entradas son cronol√≥gicas (Blog); P√°ginas son est√°ticas (Home)", "P√°ginas tienen categor√≠as; Entradas no", "Entradas son privadas; P√°ginas p√∫blicas"], a: 1, e: "Las entradas fluyen en el tiempo; las p√°ginas estructuran la web de forma fija." },
        { q: "¬øPara qu√© sirve t√©cnicamente un Tema Hijo (Child Theme)?", o: ["Para hacer que la web cargue m√°s r√°pido", "Para preservar cambios de c√≥digo al actualizar el tema padre", "Para instalar demos del tema", "Para mejorar el SEO autom√°ticamente"], a: 1, e: "Evita que las actualizaciones del desarrollador sobrescriban tus personalizaciones de c√≥digo." },
        { q: "En WooCommerce, ¬ød√≥nde se activa la configuraci√≥n de impuestos?", o: ["En cada producto individualmente", "En Ajustes > Generales (activar casilla)", "En Apariencia > Personalizar", "Viene activado por defecto"], a: 1, e: "WooCommerce oculta la pesta√±a de impuestos hasta que marcas la casilla de que los necesitas." },
        { q: "¬øQu√© herramienta del navegador se usa para ver el c√≥digo y depurar errores?", o: ["El historial de navegaci√≥n", "El administrador de tareas", "DevTools (Inspeccionar elemento)", "La barra de marcadores"], a: 2, e: "Pulsando F12 o Click Derecho > Inspeccionar, ves el HTML/CSS real que se est√° renderizando." },
        { q: "¬øQu√© es el 'Slug' en una direcci√≥n web?", o: ["El protocolo de seguridad (https)", "El nombre del dominio principal", "La parte final amigable de la URL", "La extensi√≥n del archivo (.html)"], a: 2, e: "Identifica el recurso espec√≠fico (ej: /contacto) de forma legible para humanos y bots." },
        { q: "¬øQu√© plugin de cach√© se considera una referencia Premium en el sector?", o: ["W3 Total Cache (Gratis)", "WP Rocket (De pago)", "Autoptimize (Gratis)", "Super Cache (Gratis)"], a: 1, e: "WP Rocket es el est√°ndar de pago por su facilidad de configuraci√≥n y rendimiento." },
        { q: "¬øPara qu√© sirve el atributo 'Alt Text' en las im√°genes?", o: ["Para mostrar el t√≠tulo al pasar el rat√≥n", "Para mejorar la accesibilidad y el SEO", "Para reducir el peso del archivo", "Para poner un borde decorativo"], a: 1, e: "Describe la imagen a Google y a las personas que usan lectores de pantalla." },
        { q: "¬øQu√© es el Favicon de una p√°gina web?", o: ["El logotipo que aparece en el pie de p√°gina", "El icono peque√±o en la pesta√±a del navegador", "La imagen de fondo de la web", "El bot√≥n de men√∫ en m√≥viles"], a: 1, e: "Es parte fundamental de la identidad de marca en el navegador." },
        { q: "En LocalWP, ¬øqu√© funci√≥n cumple un 'Blueprint'?", o: ["Es un error de la base de datos", "Es una plantilla de sitio guardada para reutilizar", "Es una copia de seguridad en la nube", "Es el archivo de configuraci√≥n"], a: 1, e: "Permite guardar tu configuraci√≥n de plugins/temas favorita para iniciar proyectos r√°pido." },
        { q: "¬øQu√© significan las siglas CMS?", o: ["Code Master System", "Content Management System", "Creative Mode Style", "Computer Made Simple"], a: 1, e: "Sistema de Gesti√≥n de Contenidos. WordPress es el CMS m√°s usado del mundo." },
        { q: "En Elementor, ¬øcu√°l es la diferencia entre Margin y Padding?", o: ["Son exactamente lo mismo", "Margin es espacio externo; Padding es espacio interno", "Margin es espacio interno; Padding es espacio externo", "Padding es solo para textos"], a: 1, e: "Margin separa elementos entre s√≠. Padding separa el contenido del borde de su propia caja." },
        { q: "¬øQu√© es un 'Breadcrumb' (Miga de pan)?", o: ["Un tipo de cookie de rastreo", "Un rastro de navegaci√≥n jer√°rquico", "Un error de p√°gina no encontrada", "Un widget de men√∫ lateral"], a: 1, e: "Mejora la experiencia de usuario indicando la ruta (ej: Inicio > Tienda > Zapatos)." },
        { q: "¬øC√≥mo se llama el editor de contenidos nativo actual de WordPress?", o: ["Editor Cl√°sico (TinyMCE)", "Elementor Builder", "Gutenberg (Editor de Bloques)", "Divi Builder"], a: 2, e: "Desde la versi√≥n 5.0, WordPress usa bloques para maquetar el contenido de entradas." },
        { q: "¬øQu√© implica el concepto 'Responsive Design'?", o: ["Que la web responde muy r√°pido", "Que el dise√±o se adapta a cualquier tama√±o de pantalla", "Que usa comandos de voz", "Que solo funciona en m√≥viles"], a: 1, e: "La web debe ser fluida y verse bien en escritorio, tablet y m√≥vil." },
        { q: "¬øCu√°l es la funci√≥n principal de Wordfence?", o: ["Mejorar la velocidad de carga", "Proteger la web con Firewall y esc√°ner", "Gestionar copias de seguridad", "Traducir la web a otros idiomas"], a: 1, e: "Es un plugin de seguridad que bloquea tr√°fico malicioso e intentos de login." },
        { q: "¬øQu√© estado de pedido indica que el pago se ha recibido correctamente?", o: ["Pendiente de pago", "En espera", "Procesando", "Completado"], a: 2, e: "'Procesando' significa que el dinero entr√≥ y debes preparar el env√≠o. 'Completado' es enviado." },
        { q: "¬øQu√© recomendaci√≥n de usabilidad se aplica a los men√∫s de navegaci√≥n?", o: ["Poner siempre el enlace de 'Inicio'", "Evitar tener m√°s de 7 elementos principales", "Usar muchos colores distintos", "Poner el logo en el centro"], a: 1, e: "La memoria a corto plazo gestiona mal listas largas (Ley de Miller)." },
        { q: "¬øQu√© es el 'Loop' de WordPress a nivel t√©cnico?", o: ["Un error de redirecci√≥n infinita", "El c√≥digo PHP que procesa y muestra los posts", "Un plugin de reproducci√≥n de m√∫sica", "El √°rea de widgets del pie de p√°gina"], a: 1, e: "Es el bucle que recorre la base de datos para pintar las entradas en pantalla." },
        { q: "¬øQu√© archivo CSS tiene prioridad para sobrescribir estilos?", o: ["El style.css del tema padre", "El archivo bootstrap.css", "El style.css del tema hijo o CSS adicional", "El archivo normalize.css"], a: 2, e: "Por la regla de cascada, los estilos cargados al final sobrescriben a los anteriores." },
        { q: "¬øQu√© caracteriza a una Landing Page efectiva?", o: ["Tener muchos men√∫s de navegaci√≥n", "Estar enfocada en una √∫nica conversi√≥n (CTA)", "Tener mucha informaci√≥n corporativa", "Ser la p√°gina de inicio siempre"], a: 1, e: "Se eliminan distracciones para que el usuario haga una sola cosa (comprar/suscribirse)." },
        { q: "¬øPara qu√© se usa el plugin 'Loco Translate'?", o: ["Para traducir la web autom√°ticamente", "Para traducir cadenas internas de temas/plugins", "Para mover la web de servidor", "Para cambiar el idioma del admin"], a: 1, e: "Permite editar archivos .po/.mo para cambiar textos como 'Read More' a 'Leer M√°s'." },
        { q: "¬øQu√© es un Shortcode en WordPress?", o: ["Un c√≥digo corto entre corchetes [ ]", "Un error de programaci√≥n PHP", "Una contrase√±a de acceso", "Un enlace permanente corto"], a: 0, e: "Ejecuta funcionalidades complejas (formularios, galer√≠as) con una etiqueta simple." },
        { q: "Si aparece la 'Pantalla Blanca de la Muerte' (WSOD), ¬øqu√© suele indicar?", o: ["Que el monitor est√° roto", "Un error de PHP/Memoria o incompatibilidad", "Que la web ha sido hackeada", "Que no hay conexi√≥n a internet"], a: 1, e: "Generalmente lo causa un plugin defectuoso. Se arregla desactiv√°ndolo por FTP." },
        { q: "¬øQu√© etiqueta HTML es la m√°s importante para el t√≠tulo principal (SEO)?", o: ["La etiqueta H2", "La etiqueta H1", "La etiqueta Bold (Negrita)", "La etiqueta Span"], a: 1, e: "Solo debe haber un H1 por p√°gina describiendo el tema principal." },
        { q: "¬øQu√© es 'Squoosh' en el contexto del curso?", o: ["Un plugin de cach√©", "Una herramienta online para comprimir im√°genes", "Un tema de WordPress", "Un servidor de hosting"], a: 1, e: "Recomendado para optimizar el peso de las fotos antes de subirlas a la web." },
        { q: "¬øQu√© aporta el protocolo HTTPS frente al HTTP?", o: ["Mayor velocidad de carga", "Cifrado de seguridad (SSL) en la conexi√≥n", "Mejor dise√±o visual", "Compatibilidad con m√≥viles"], a: 1, e: "Es obligatorio por seguridad y confianza (el candado verde)." },
        { q: "¬øQu√© es un 'Global Widget' en Elementor Pro?", o: ["Un widget que se ve en todo el mundo", "Un elemento que se actualiza en todas sus instancias", "Un widget de traducci√≥n autom√°tica", "Un mapa de ubicaci√≥n global"], a: 1, e: "Si lo editas en un sitio, cambia en todas las partes de la web donde est√© puesto." },
        { q: "¬øQu√© significa la 'Regla de los 3 clics' en UX?", o: ["Hacer 3 clics para guardar cambios", "El usuario debe encontrar lo que busca en 3 clics", "El rat√≥n debe tener 3 botones", "WordPress se instala en 3 pasos"], a: 1, e: "Principio de arquitectura de informaci√≥n para que la navegaci√≥n sea fluida." },
        { q: "¬øQu√© implica la estrategia 'Mobile First'?", o: ["Dise√±ar primero para m√≥vil y luego escalar", "Dise√±ar solo para dispositivos m√≥viles", "Que el m√≥vil es m√°s caro que el PC", "Usar el m√≥vil para dise√±ar la web"], a: 0, e: "Prioriza la experiencia en pantallas peque√±as, que es donde est√° la mayor√≠a del tr√°fico." },
        { q: "Para vender un ebook, ¬øqu√© casillas marcas en WooCommerce?", o: ["Virtual y Descargable", "Solo Virtual", "Solo Descargable", "Producto F√≠sico"], a: 0, e: "Virtual elimina el env√≠o f√≠sico; Descargable habilita la subida del archivo." },
        { q: "¬øQu√© es una Zona de Env√≠o en WooCommerce?", o: ["El almac√©n f√≠sico", "√Årea geogr√°fica con m√©todos de env√≠o propios", "La direcci√≥n del cliente", "Un plugin de correos"], a: 1, e: "Permite definir tarifas distintas para Pen√≠nsula, Baleares, Canarias, etc." },
        { q: "¬øCu√°l es el hook principal para inyectar scripts en el pie de p√°gina?", o: ["wp_head", "wp_footer", "wp_body", "wp_bottom"], a: 1, e: "Es donde se cargan los scripts de JS y la barra de administraci√≥n." },
        { q: "¬øQu√© funci√≥n cumple el archivo functions.php?", o: ["Guardar textos", "Ampliar la funcionalidad del tema (como un plugin)", "Conectar la base de datos", "Definir los estilos CSS"], a: 1, e: "Permite a√±adir c√≥digo PHP personalizado al tema activo." },
        { q: "Si quieres ocultar una p√°gina a Google, ¬øqu√© meta etiqueta usas?", o: ["noindex", "nofollow", "hidden", "private"], a: 0, e: "Indica a los buscadores que no incluyan esa URL en sus resultados." },
        { q: "Si tienes 'Contenido Mixto' en una web SSL, ¬øqu√© significa?", o: ["Idiomas mezclados", "Recursos HTTP cargando en una web HTTPS", "Enlaces rotos", "Plugins incompatibles"], a: 1, e: "Rompe la seguridad del candado. Suele ser por im√°genes con http://." },
        { q: "¬øQu√© es un Iframe?", o: ["Una imagen", "Una ventana para incrustar contenido externo (Youtube)", "Un plugin", "Un error"], a: 1, e: "Etiqueta est√°ndar para embeber v√≠deos o mapas." },
        { q: "Si la web carga sin estilos (CSS), ¬øqu√© suele fallar?", o: ["La base de datos", "Las rutas (URLs) en Ajustes o SSL mal configurado", "El tema se ha borrado", "Falta memoria PHP"], a: 1, e: "El navegador bloquea los estilos si se sirven por protocolo inseguro o la ruta est√° mal." },
        { q: "¬øQu√© es 'MySQL'?", o: ["El dise√±o", "El sistema de base de datos de WordPress", "El servidor", "Un plugin"], a: 1, e: "Es donde se guarda toda la informaci√≥n textual y configuraciones." },
        { q: "Si el cron de WP falla, ¬øqu√© se recomienda?", o: ["Desactivarlo y usar el cron real del servidor", "Borrarlo", "Instalar un plugin de cron", "No hacer nada"], a: 0, e: "El cron real es m√°s fiable y no depende de que haya visitas en la web." },
        { q: "¬øQu√© ventaja tiene el formato WebP?", o: ["Soporta capas", "Mejor compresi√≥n y calidad que JPG/PNG", "Es vectorial", "Lo leen servidores viejos"], a: 1, e: "Est√°ndar moderno para velocidad web." },
        { q: "¬øQu√© es un 'Mockup'?", o: ["C√≥digo final", "Boceto visual est√°tico del dise√±o", "Copia de seguridad", "Men√∫"], a: 1, e: "Fase de dise√±o previo a la programaci√≥n." },
        { q: "¬øQu√© hace 'Smush'?", o: ["Crea galer√≠as", "Optimiza im√°genes autom√°ticamente", "Borra fotos", "Pone marcas de agua"], a: 1, e: "Plugin de WPO para im√°genes." },
        { q: "¬øQu√© es el 'Modo Mantenimiento'?", o: ["Error 404", "P√°gina de espera mientras se trabaja", "Fallo servidor", "Plugin"], a: 1, e: "Oculta la web en construcci√≥n." },
        { q: "¬øQu√© es un 'Sidebar'?", o: ["Men√∫ principal", "Zona lateral para widgets", "Pie de p√°gina", "Imagen"], a: 1, e: "Barra lateral cl√°sica." },
        { q: "Diferencia 'Redirecci√≥n 301' vs '302':", o: ["Ninguna", "Permanente vs Temporal", "Error vs Acierto", "Lenta vs R√°pida"], a: 1, e: "301 traspasa la autoridad SEO." },
        { q: "¬øPara qu√© sirve un 'Ancla' (Anchor)?", o: ["Enlace externo", "Enlace a una secci√≥n interna de la p√°gina", "Error", "Men√∫"], a: 1, e: "Navegaci√≥n vertical (One Page)." }
    ];

    let questions = []; 
    let timer;
    let timeLeft = 45 * 60; 

    function init() {
        if(typeof DB === 'undefined') return alert("‚ö†Ô∏è ERROR: No has pegado las preguntas.");
        
        // Seleccionar 50 aleatorias
        questions = DB.sort(() => 0.5 - Math.random()).slice(0, 50);
        
        const container = document.getElementById('quiz-container');
        container.innerHTML = ""; 
        
        questions.forEach((q, index) => {
            // --- FIX: A√±adir comprobaci√≥n para evitar errores si una pregunta no tiene opciones ---
            if (!q.o || !Array.isArray(q.o)) {
                console.error(`Pregunta #${index} omitida por no tener opciones v√°lidas.`, q);
                return; // Saltar esta pregunta
            }
            // --- FIN DEL FIX ---

            let html = `
                <div class="card" id="card-${index}">
                    <div class="q-text"><span style="color:#2271b1; font-weight:800;">#${index + 1}</span> ${q.q}</div>
            `;
            
            // Barajar opciones visualmente
            let indices = q.o.map((_, i) => i);
            indices.sort(() => 0.5 - Math.random());

            html += `<div class="options-group">`;
            indices.forEach(i => {
                html += `
                    <label class="option-label" id="lbl-${index}-${i}">
                        <input type="radio" name="q_${index}" value="${i}">
                        ${q.o[i]}
                    </label>
                `;
            });

            html += `</div>
                     <div class="explanation-box" id="exp-${index}"></div>
                     </div>`;
            container.innerHTML += html;
        });

        startTimer();
        
        // Barra de progreso
        document.querySelectorAll('input').forEach(i => {
            i.addEventListener('change', () => {
                const answered = document.querySelectorAll('input:checked').length;
                document.getElementById('progress').style.width = `${(answered/50)*100}%`;
            });
        });
    }

    window.finishExam = function() {
        clearInterval(timer);
        
        let correctCount = 0;
        let reviewHTML = "";

        // Recorremos las 50 preguntas
        questions.forEach((q, index) => {
            const card = document.getElementById(`card-${index}`);
            const expBox = document.getElementById(`exp-${index}`);
            const selected = document.querySelector(`input[name="q_${index}"]:checked`);
            
            let userVal = selected ? parseInt(selected.value) : -1; 
            let isCorrect = (userVal === q.a);
            
            // Bloquear inputs
            card.querySelectorAll('input').forEach(i => i.disabled = true);

            // LOGICA VISUAL DETALLADA
            if (isCorrect) {
                correctCount++;
                card.classList.add('correct-card');
                document.getElementById(`lbl-${index}-${userVal}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚úÖ ¬°CORRECTO!</strong>${q.e}`;
                
                // Add to modal review
                reviewHTML += `<div class="review-item r-correct"><b>${index+1}. Acierto</b><br>Tu respuesta: ${q.o[userVal]}</div>`;
            
            } else if (userVal !== -1) {
                // Fall√≥
                card.classList.add('wrong-card');
                document.getElementById(`lbl-${index}-${userVal}`).classList.add('user-wrong');
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚ùå FALLO</strong><br>La correcta era: <b>${q.o[q.a]}</b><br><em>${q.e}</em>`;
                
                reviewHTML += `<div class="review-item r-wrong"><b>${index+1}. Fallo</b><br>Tu respuesta: ${q.o[userVal]}<br>Correcta: <strong>${q.o[q.a]}</strong></div>`;
            
            } else {
                // En blanco
                card.classList.add('wrong-card');
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚ö™ EN BLANCO</strong><br>La correcta era: <b>${q.o[q.a]}</b><br><em>${q.e}</em>`;
                
                reviewHTML += `<div class="review-item r-wrong"><b>${index+1}. En blanco</b><br>Correcta: <strong>${q.o[q.a]}</strong></div>`;
            }
            
            expBox.style.display = 'block';
        });

        // BAREMO CEI
        let verdict = "";
        let color = "";

        if (correctCount >= 45) { // 45-50
            verdict = "SOBRESALIENTE üèÜ";
            color = "#28a745";
        } else if (correctCount >= 40) { // 40-44
            verdict = "NOTABLE üåü";
            color = "#17a2b8";
        } else if (correctCount >= 35) { // 35-39
            verdict = "BIEN üëç";
            color = "#2271b1";
        } else if (correctCount >= 30) { // 30-34
            verdict = "APTO üëå";
            color = "#fd7e14";
        } else {
            verdict = "NO APTO ‚ùå";
            color = "#dc3545";
        }

        // PINTAR MODAL
        document.getElementById('score-display').innerText = `${correctCount} / 50`;
        document.getElementById('score-display').style.color = color;
        
        const vText = document.getElementById('verdict-text');
        vText.innerText = verdict;
        vText.style.color = color;

        document.getElementById('res-correct').innerText = correctCount;
        document.getElementById('res-wrong').innerText = 50 - correctCount;

        document.getElementById('detailed-review').innerHTML = reviewHTML;
        document.getElementById('result-modal').style.display = 'flex';
    };

    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            let m = Math.floor(timeLeft / 60);
            let s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if(timeLeft <= 0) finishExam();
        }, 1000);
    }

    window.onload = function() {
        if(typeof DB !== 'undefined') init();
    };

</script>
</body>
</html>