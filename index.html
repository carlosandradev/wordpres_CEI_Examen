<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador WordPress CEI - Versi√≥n Final Pro</title>
    <style>
        :root { --primary: #2271b1; --success: #00a32a; --error: #d63638; --bg: #f0f0f1; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: #3c434a; margin: 0; padding-bottom: 100px; }
        
        /* HEADER FIJO */
        .header { position: fixed; top: 0; left: 0; right: 0; background: #fff; border-bottom: 1px solid #c3c4c7; padding: 10px 20px; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .logo { font-weight: 700; color: var(--primary); font-size: 1.2rem; }
        .timer-box { font-variant-numeric: tabular-nums; font-size: 1.5rem; font-weight: 600; color: #1d2327; }
        .pause-btn { background: #f6f7f7; border: 1px solid #2271b1; color: #2271b1; padding: 5px 15px; cursor: pointer; border-radius: 3px; font-weight: 600; transition: 0.2s; }
        .pause-btn:hover { background: #f0f0f1; }

        /* CONTENEDOR */
        .container { max-width: 800px; margin: 80px auto 20px; padding: 0 15px; }

        /* TARJETAS DE PREGUNTA */
        .card { background: #fff; border: 1px solid #c3c4c7; padding: 20px; margin-bottom: 20px; border-left: 4px solid var(--primary); box-shadow: 0 1px 2px rgba(0,0,0,0.05); position: relative; }
        .q-text { font-size: 1.1rem; font-weight: 600; margin-bottom: 15px; line-height: 1.4; }
        
        .option-label { display: flex; align-items: flex-start; gap: 10px; padding: 10px; border: 1px solid #dcdcde; border-radius: 4px; cursor: pointer; transition: all 0.2s; margin-bottom: 8px; }
        .option-label:hover { background: #f6f7f7; border-color: var(--primary); }
        .option-label input { margin-top: 4px; transform: scale(1.2); cursor: pointer; }

        /* ESTADOS DE RESPUESTA */
        .option-label.correct { background: #edfaef; border-color: var(--success); color: #005c1e; }
        .option-label.wrong { background: #fcf0f1; border-color: var(--error); color: #8a2424; text-decoration: line-through; }
        .explanation-box { display: none; margin-top: 15px; padding: 12px; background: #f0f0f1; border-left: 4px solid #72aee6; font-size: 0.95rem; }
        
        /* BOTONES */
        .check-btn { background: var(--primary); color: white; border: none; padding: 8px 16px; border-radius: 3px; cursor: pointer; font-size: 0.9rem; margin-top: 10px; }
        .check-btn:hover { background: #135e96; }
        .check-btn:disabled { background: #a7aaad; cursor: default; }

        .fab-finish { position: fixed; bottom: 20px; right: 20px; background: var(--error); color: white; padding: 15px 30px; border-radius: 50px; border: none; font-size: 1.1rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 999; transition: transform 0.2s; }
        .fab-finish:hover { transform: scale(1.05); background: #b32d2e; }

        /* MODALES */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; justify-content: center; align-items: center; flex-direction: column; color: white; text-align: center; }
        .modal-content { background: white; color: #333; padding: 40px; border-radius: 8px; max-width: 500px; width: 90%; text-align: center; }
        .score-big { font-size: 4rem; font-weight: 800; margin: 10px 0; color: var(--primary); }
        .btn-restart { background: var(--success); color: white; border: none; padding: 15px 30px; font-size: 1.2rem; cursor: pointer; border-radius: 5px; width: 100%; margin-top: 20px; }
        
        /* BARRA PROGRESO */
        .progress-bar { position: fixed; top: 60px; left: 0; height: 5px; background: #ddd; width: 100%; z-index: 999; }
        .progress-fill { height: 100%; background: #00a0d2; width: 0%; transition: width 0.3s; }
    </style>
</head>
<body>

    <div id="pause-modal" class="modal">
        <h1>EXAMEN PAUSADO</h1>
        <button class="pause-btn" onclick="togglePause()" style="font-size:1.5rem; padding: 20px 40px; background:white; border:none;">REANUDAR</button>
    </div>

    <div id="results-modal" class="modal">
        <div class="modal-content">
            <h2>Resultado Final</h2>
            <div id="score-display" class="score-big">0.0</div>
            <p id="score-msg" style="font-size: 1.2rem;"></p>
            <div style="text-align:left; margin-top:20px; background:#f0f0f1; padding:15px; border-radius:5px;">
                <p>‚úÖ Aciertos: <span id="res-correct">0</span></p>
                <p>‚ùå Fallos: <span id="res-wrong">0</span></p>
                <p>‚ö™ Sin responder: <span id="res-blank">0</span></p>
            </div>
            <button class="btn-restart" onclick="location.reload()">GENERAR NUEVO EXAMEN</button>
        </div>
    </div>

    <header class="header">
        <div class="logo">Examen WP (50 Preguntas)</div>
        <div style="display: flex; gap: 15px; align-items: center;">
            <div class="timer-box" id="timer">45:00</div>
            <button class="pause-btn" onclick="togglePause()">II PAUSA</button>
        </div>
    </header>
    <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>

    <div class="container" id="quiz-container"></div>

    <button class="fab-finish" onclick="finishExam()">FINALIZAR Y CORREGIR TODO</button>

<script>
    // --- BASE DE DATOS CORREGIDA (120 PREGUNTAS) ---
    const DB = [
        // --- BLOQUE 1: CONCEPTOS B√ÅSICOS DE WORDPRESS (Lo esencial) ---
        { q: "¬øCu√°l es la diferencia principal entre una Entrada (Post) y una P√°gina?", o: ["No hay diferencia", "Las Entradas son para noticias (cronol√≥gicas) y las P√°ginas para contenido est√°tico (Qui√©nes somos)", "Las P√°ginas no admiten fotos", "Las Entradas son para vender"], a: 1, e: "Pregunta cl√°sica. Entradas = Blog/Noticias. P√°ginas = Estructura fija de la web." },
        { q: "¬øQu√© es un Plugin?", o: ["Un dise√±o", "Una herramienta que instalas para a√±adir nuevas funciones a WordPress (como un formulario o tienda)", "Un virus", "La base de datos"], a: 1, e: "Son como las apps de tu m√≥vil: a√±aden funcionalidades extra." },
        { q: "¬øQu√© es un Tema (Theme)?", o: ["La apariencia visual de la web (dise√±o, colores, tipograf√≠a)", "El panel de control", "Un tipo de usuario", "El hosting"], a: 0, e: "Es el encargado de definir c√≥mo se 've' tu web." },
        { q: "¬øPara qu√© sirve la Biblioteca de Medios?", o: ["Para guardar plugins", "Para gestionar todas las im√°genes, v√≠deos y documentos subidos", "Para ver los comentarios", "Para editar c√≥digo"], a: 1, e: "Todo archivo que subes a la web va aqu√≠." },
        { q: "Si quieres que tu web NO aparezca en Google mientras la est√°s creando, ¬øqu√© marcas?", o: ["Nada, Google no entra", "La casilla 'Disuadir a los motores de b√∫squeda' en Ajustes > Lectura", "Borras la web", "Pones una contrase√±a al ordenador"], a: 1, e: "Muy importante acordarse de desmarcarla al terminar el proyecto." },
        { q: "¬øD√≥nde se cambia el T√≠tulo del Sitio y la Descripci√≥n Corta?", o: ["En Apariencia > Men√∫s", "En Ajustes > Generales", "En Plugins", "En Usuarios"], a: 1, e: "Es la configuraci√≥n b√°sica de identidad de tu WordPress." },
        { q: "¬øQu√© es el 'Slug'?", o: ["Un virus", "La parte final de la URL que identifica una p√°gina (ej: miweb.com/contacto)", "El dominio", "El t√≠tulo"], a: 1, e: "Debe ser corto, en min√∫sculas y sin espacios." },
        { q: "¬øQu√© estructura de Enlaces Permanentes es la mejor para el SEO?", o: ["Simple (?p=123)", "Nombre de la entrada (Post name)", "Num√©rico", "Mes y nombre"], a: 1, e: "Ayuda a Google y a los usuarios a entender de qu√© va la p√°gina solo leyendo el enlace." },
        { q: "¬øQu√© rol de usuario tiene acceso a TODO (instalar plugins, cambiar temas, crear usuarios)?", o: ["Editor", "Autor", "Administrador", "Colaborador"], a: 2, e: "Es el rol que tienes t√∫ como creador de la web." },
        { q: "¬øC√≥mo se llama el archivo donde se guardan los datos de conexi√≥n a la base de datos?", o: ["index.php", "wp-admin.php", "wp-config.php", "style.css"], a: 2, e: "Pregunta de examen de Rafa. Es el archivo de configuraci√≥n vital." },

        // --- BLOQUE 2: ELEMENTOR (Dise√±o Visual) ---
        { q: "¬øPara qu√© sirve el 'Navegador' (Navigator) en Elementor?", o: ["Para entrar en Google", "Es un panel de capas para ver y seleccionar secciones f√°cilmente", "Para ver el mapa", "Para guardar"], a: 1, e: "Fundamental cuando tienes elementos superpuestos o no encuentras una secci√≥n." },
        { q: "¬øQu√© diferencia hay entre Margen (Margin) y Relleno (Padding)?", o: ["Son iguales", "Margen es espacio FUERA del borde (separa elementos), Relleno es espacio DENTRO (separa contenido del borde)", "Al rev√©s", "Solo sirven para texto"], a: 1, e: "Margen separa cajas entre s√≠. Relleno hace la caja m√°s grande por dentro." },
        { q: "¬øQu√© es el 'Modo Responsive' en Elementor?", o: ["Un modo r√°pido", "La herramienta para adaptar el dise√±o a M√≥vil y Tablet", "Un plugin", "Un error"], a: 1, e: "Te permite cambiar tama√±os de letra o m√°rgenes solo para el m√≥vil." },
        { q: "Si quieres que una secci√≥n ocupe toda la altura de la pantalla, ¬øqu√© pones?", o: ["Alto: 500px", "Alto M√≠nimo: 100 VH (Viewport Height)", "Ancho completo", "Padding 0"], a: 1, e: "100 VH significa el 100% de la altura visible del dispositivo." },
        { q: "¬øQu√© es una Plantilla (Template) de Elementor?", o: ["Un dise√±o guardado (ej: una cabecera) que puedes reutilizar en toda la web", "Un plugin", "Una p√°gina", "Un men√∫"], a: 0, e: "Ahorra tiempo y mantiene la coherencia del dise√±o." },
        { q: "¬øPara qu√© sirve el Z-Index?", o: ["Para el zoom", "Para decidir qu√© elemento se ve encima de otro (capas)", "Para el color", "Para el borde"], a: 1, e: "Cuanto mayor es el n√∫mero, m√°s 'arriba' est√° el elemento." },
        { q: "¬øC√≥mo arreglas que el men√∫ tape el t√≠tulo de una secci√≥n al hacer clic en un enlace (ancla)?", o: ["Borrando el men√∫", "Usando la opci√≥n 'Desplazamiento de ancla' (Offset)", "Con margen negativo", "No tiene arreglo"], a: 1, e: "Compensa la altura del men√∫ fijo." },
        { q: "¬øQu√© es un 'Global Color'?", o: ["Un color mundial", "Un color guardado en ajustes que, si lo cambias, se actualiza en toda la web", "Un fondo", "Un error"], a: 1, e: "Esencial para cambiar la identidad corporativa r√°pidamente." },
        { q: "¬øQu√© widget usas para poner un mapa de Google?", o: ["Imagen", "Google Maps", "Video", "Editor de texto"], a: 1, e: "Viene por defecto en Elementor." },
        { q: "Si un cambio de estilo no se ve en la web pero s√≠ en el editor, ¬øqu√© suele ser?", o: ["Virus", "Problema de Cach√© (del navegador o plugin)", "Base de datos rota", "Falta pagar"], a: 1, e: "Borrar cach√© o 'Regenerar CSS' suele solucionarlo." },

        // --- BLOQUE 3: WOOCOMMERCE (Tienda) ---
        { q: "¬øQu√© tipo de producto usas para vender una camiseta con tallas S, M y L?", o: ["Producto Simple", "Producto Variable", "Producto Virtual", "Producto Externo"], a: 1, e: "Permite crear variaciones, cada una con su stock y precio si quieres." },
        { q: "Si vendes un servicio o un PDF (algo que no se env√≠a en caja), ¬øqu√© casilla marcas?", o: ["Virtual", "F√≠sico", "Agrupado", "Externo"], a: 0, e: "Al marcar 'Virtual', desaparecen los costes de env√≠o en el carrito." },
        { q: "¬øQu√© estado de pedido significa que el pago ha sido correcto?", o: ["Pendiente de pago", "Cancelado", "Procesando", "En espera"], a: 2, e: "Significa que el dinero ha llegado y debes preparar el pedido." },
        { q: "¬øPara qu√© sirve una 'Zona de Env√≠o'?", o: ["Para saber d√≥nde est√° el almac√©n", "Para definir precios de env√≠o distintos seg√∫n el lugar (ej: Pen√≠nsula vs Canarias)", "Para el mapa", "Para los impuestos"], a: 1, e: "Permite cobrar portes diferentes seg√∫n el destino." },
        { q: "¬øD√≥nde se gestionan los pedidos recibidos?", o: ["En Entradas", "En WooCommerce > Pedidos", "En Productos", "En Ajustes"], a: 1, e: "Es tu bandeja de entrada de ventas." },
        { q: "¬øQu√© m√©todo de pago podemos usar en el curso para simular compras?", o: ["Bitcoin", "Transferencia bancaria o Contrareembolso", "Tarjeta real obligatoria", "Paypal real"], a: 1, e: "Permite probar todo el proceso de compra sin gastar dinero real." },
        { q: "¬øQu√© es un Producto Agrupado?", o: ["Un pack indivisible", "Una p√°gina que muestra varios productos simples juntos (ej: colecci√≥n de ropa)", "Un producto variable", "Un descuento"], a: 1, e: "El usuario puede a√±adir cantidades de cada sub-producto." },
        { q: "Si quieres vender productos de Amazon (Afiliados), ¬øqu√© tipo usas?", o: ["Producto Simple", "Producto Externo/Afiliado", "Producto Variable", "Virtual"], a: 1, e: "El bot√≥n de compra lleva a la web de Amazon en vez de al carrito." },
        { q: "¬øPor qu√© no sale la pesta√±a de Impuestos al principio?", o: ["Es de pago", "Hay que activarla en Ajustes > General primero", "Es un error", "No existe"], a: 1, e: "WooCommerce viene simplificado por defecto." },
        { q: "¬øQu√© plugin mejora los desplegables de tallas poni√©ndolos como botoncitos de colores?", o: ["Contact Form 7", "Variation Swatches", "Yoast", "Jetpack"], a: 1, e: "Mejora mucho la experiencia de usuario visual." },

        // --- BLOQUE 4: HERRAMIENTAS Y PLUGINS FAMOSOS ---
        { q: "¬øQu√© es 'LocalWP'?", o: ["Un plugin", "Un programa para crear webs en tu ordenador sin internet", "Un hosting", "Un tema"], a: 1, e: "Es donde desarrollamos las webs en el curso antes de subirlas." },
        { q: "¬øPara qu√© sirve el plugin 'Yoast SEO'?", o: ["Para dise√±ar", "Para ayudar a posicionar en Google (sem√°foros verde/rojo)", "Para seguridad", "Para copias"], a: 1, e: "Te dice si tu contenido es amigable para Google." },
        { q: "¬øQu√© hace un plugin de Copias de Seguridad (Backup)?", o: ["Borra la web", "Guarda una copia de todos los archivos y base de datos por si algo se rompe", "Traduce", "Vende"], a: 1, e: "Ejemplos: All-in-One WP Migration o Duplicator." },
        { q: "¬øPara qu√© sirve 'Contact Form 7'?", o: ["Para crear formularios de contacto", "Para SEO", "Para tiendas", "Para seguridad"], a: 0, e: "Es el est√°ndar cl√°sico para formularios." },
        { q: "¬øQu√© hace un plugin de Seguridad como Wordfence?", o: ["Mejora el dise√±o", "Protege la web de ataques y virus (Firewall)", "Vende productos", "Traduce"], a: 1, e: "Bloquea intentos de acceso maliciosos." },
        { q: "¬øQu√© es 'Squoosh'?", o: ["Un juego", "Una web de Google para comprimir im√°genes antes de subirlas", "Un plugin", "Un tema"], a: 1, e: "Clave para que las fotos pesen poco." },
        { q: "¬øQu√© es 'Loco Translate'?", o: ["Un traductor autom√°tico", "Un plugin para traducir textos t√©cnicos del tema (ej: 'Read more' -> 'Leer m√°s')", "Un mapa", "Un error"], a: 1, e: "Permite traducir las cadenas internas de WordPress." },
        { q: "¬øQu√© es un CPT (Custom Post Type)?", o: ["Un post normal", "Un tipo de contenido personalizado (ej: Proyectos, Recetas)", "Un usuario", "Un plugin"], a: 1, e: "Se usa cuando las Entradas y P√°ginas se quedan cortas." },
        { q: "¬øQu√© es un Shortcode?", o: ["Un c√≥digo corto entre corchetes [ ] que invoca una funci√≥n", "Un error", "Una contrase√±a", "Un virus"], a: 0, e: "Ejemplo: [contact-form-7 id='123']." },
        { q: "¬øQu√© es el 'Lazy Load'?", o: ["Carga lenta", "Carga diferida (las im√°genes cargan solo cuando bajas a verlas)", "Un error", "Un virus"], a: 1, e: "Hace que la web cargue mucho m√°s r√°pido al principio." },

        // --- BLOQUE 5: CONCEPTOS GENERALES (Hosting, Dominios, Legal) ---
        { q: "¬øQu√© es el Hosting?", o: ["El nombre de la web", "El espacio en un servidor donde se guardan tus archivos (la casa)", "El dise√±o", "El navegador"], a: 1, e: "Sin hosting no hay web online." },
        { q: "¬øQu√© es el Dominio?", o: ["El hosting", "La direcci√≥n de la web (ej: google.com)", "El dise√±o", "El c√≥digo"], a: 1, e: "Es lo que escribes en la barra del navegador." },
        { q: "¬øQu√© es HTTPS (el candadito)?", o: ["Seguridad (conexi√≥n cifrada)", "Web lenta", "Web antigua", "Virus"], a: 0, e: "Obligatorio hoy en d√≠a para que la web sea segura." },
        { q: "¬øQu√© es el 'Responsive Design'?", o: ["Que la web responda r√°pido", "Que la web se adapte bien a m√≥viles y tablets", "Que sea barata", "Que sea azul"], a: 1, e: "La web debe verse bien en cualquier tama√±o de pantalla." },
        { q: "¬øQu√© es el texto ALT de una imagen?", o: ["El t√≠tulo", "Descripci√≥n para Google y personas ciegas", "El borde", "El pie de foto"], a: 1, e: "Importante para el SEO y la accesibilidad." },
        { q: "¬øQu√© documento legal es obligatorio tener en la web?", o: ["Pol√≠tica de Privacidad", "El curr√≠culum", "Instagram", "Nada"], a: 0, e: "Debes informar de qu√© haces con los datos de los usuarios." },
        { q: "Si la web se queda en blanco (Pantalla Blanca), ¬øqu√© suele ser?", o: ["Se rompi√≥ el monitor", "Error interno, normalmente por un plugin incompatible", "Virus", "Internet lento"], a: 1, e: "Suele arreglarse desactivando el √∫ltimo plugin instalado." },
        { q: "¬øCu√°l es el peso recomendado para una imagen web?", o: ["5 MB", "1 MB", "Menos de 200 KB aprox", "No importa"], a: 2, e: "Si pesan mucho, la web ir√° muy lenta." },
        { q: "¬øQu√© es un Favicon?", o: ["El logo grande", "El icono peque√±ito en la pesta√±a del navegador", "El pie de p√°gina", "Un men√∫"], a: 1, e: "Ayuda a identificar la web en las pesta√±as abiertas." },
        { q: "¬øQu√© es un Mockup?", o: ["Un dise√±o visual (boceto) de c√≥mo ser√° la web antes de hacerla", "Una copia de seguridad", "Un virus", "Un c√≥digo"], a: 0, e: "Se hace en Photoshop/Figma para ense√±ar al cliente." },

        // --- BLOQUE 6: DETALLES DEL EXAMEN CEI ---
        { q: "¬øCu√°ntas horas m√≠nimas de trabajo debe reflejar el proyecto?", o: ["10 horas", "40 horas", "100 horas", "1 hora"], a: 1, e: "Equivale a una semana de trabajo intensivo." },
        { q: "¬øSe puede usar texto falso 'Lorem Ipsum' en el proyecto final?", o: ["S√≠, en todas partes", "No, est√° prohibido (debe ser contenido real o realista)", "Solo en el blog", "Da igual"], a: 1, e: "El contenido es parte fundamental de la evaluaci√≥n." },
        { q: "¬øQu√© es obligatorio entregar junto con la URL de la web?", o: ["Nada m√°s", "Una Memoria en PDF y una copia de seguridad", "El DNI", "Una foto"], a: 1, e: "Sin la memoria explicativa no se corrige." },
        { q: "Si usas Inteligencia Artificial (IA) en el proyecto, ¬øqu√© debes hacer?", o: ["No decir nada", "Explicarlo en la memoria (qu√© prompts usaste)", "Pagar un extra", "Est√° prohibido"], a: 1, e: "Se permite, pero siendo transparente sobre su uso." },
        { q: "¬øQu√© pasa si suspendes 4 veces?", o: ["Nada", "Pierdes el derecho al diploma", "Pagas m√°s", "Repites gratis"], a: 1, e: "Es el l√≠mite de convocatorias." },
        { q: "¬øC√≥mo se llama el editor nativo de WordPress para escribir entradas?", o: ["Classic", "Gutenberg (Editor de bloques)", "Elementor", "Divi"], a: 1, e: "Es el sistema de bloques que viene por defecto." },
        { q: "¬øQu√© es la 'Jerarqu√≠a de Plantillas'?", o: ["El orden de los jefes", "Las reglas que sigue WordPress para elegir qu√© dise√±o mostrar", "Un plugin", "Un error"], a: 1, e: "Ejemplo: Si no hay dise√±o espec√≠fico de categor√≠a, usa el gen√©rico." },
        { q: "¬øQu√© es un 'Sidebar'?", o: ["Una barra lateral donde poner widgets", "El men√∫ superior", "El pie de p√°gina", "Un error"], a: 0, e: "Cl√°sico en los blogs para poner categor√≠as o buscadores." },
        { q: "¬øQu√© es una 'Categor√≠a' en el blog?", o: ["Una etiqueta", "Una forma de agrupar temas generales (ej: Deportes, Cine)", "Una p√°gina", "Un usuario"], a: 1, e: "Es jer√°rquica (pueden tener subcategor√≠as)." },
        { q: "¬øQu√© es una 'Etiqueta' (Tag)?", o: ["Una categor√≠a", "Una palabra clave espec√≠fica para describir un post", "Un men√∫", "Un plugin"], a: 1, e: "No tienen jerarqu√≠a, son detalles puntuales." }
    ];

    // VARIABLES DE ESTADO
    let questions = []; // Las 50 seleccionadas
    let userAnswers = {};
    let timer;
    let timeLeft = 45 * 60; // 45 min
    let isPaused = false;

    // INICIALIZACI√ìN
    function init() {
        // 1. Barajar y coger 50
        questions = DB.sort(() => 0.5 - Math.random()).slice(0, 50);
        
        // 2. Renderizar
        const container = document.getElementById('quiz-container');
        container.innerHTML = ""; // Limpiar
        
        questions.forEach((q, index) => {
            // Crear HTML de la pregunta
            let html = `
                <div class="card" id="card-${index}">
                    <div class="q-text">${index + 1}. ${q.q}</div>
                    <div class="options-group">
            `;
            
            let indices = q.o.map((_, i) => i); // [0, 1, 2, 3]
            // indices.sort(() => 0.5 - Math.random()); // Descomentar para barajar opciones

            indices.forEach(i => {
                html += `
                    <label class="option-label" id="lbl-${index}-${i}">
                        <input type="radio" name="q_${index}" value="${i}">
                        ${q.o[i]}
                    </label>
                `;
            });

            html += `
                    </div>
                    <button class="check-btn" onclick="check(${index})">Comprobar</button>
                    <div class="explanation-box" id="exp-${index}"></div>
                </div>
            `;
            container.innerHTML += html;
        });

        // 3. Iniciar Timer
        startTimer();
    }

    // --- L√ìGICA DE CORRECCI√ìN H√çBRIDA ---

    // 1. Funci√≥n para comprobar UNA pregunta individual (Bot√≥n azul)
    window.check = function(index) {
        const selected = document.querySelector(`input[name="q_${index}"]:checked`);
        if (!selected) return alert("Por favor, selecciona una opci√≥n antes de comprobar.");

        const val = parseInt(selected.value);
        const correct = questions[index].a;
        
        const card = document.getElementById(`card-${index}`);
        const btn = card.querySelector('.check-btn');
        const expBox = document.getElementById(`exp-${index}`);
        
        // Guardar
        userAnswers[index] = (val === correct);

        // Bloquear
        const inputs = card.querySelectorAll('input');
        inputs.forEach(inp => inp.disabled = true);
        btn.disabled = true;
        btn.textContent = "Revisado";
        btn.style.background = "#a7aaad";

        // Feedback
        if (val === correct) {
            document.getElementById(`lbl-${index}-${val}`).classList.add('correct');
            expBox.innerHTML = `<strong>‚úÖ ¬°CORRECTO!</strong><br>${questions[index].e}`;
            expBox.style.borderLeftColor = "#00a32a";
        } else {
            document.getElementById(`lbl-${index}-${val}`).classList.add('wrong');
            document.getElementById(`lbl-${index}-${correct}`).classList.add('correct');
            expBox.innerHTML = `<strong>‚ùå INCORRECTO.</strong><br>La correcta es la marcada en verde.<br><em>${questions[index].e}</em>`;
            expBox.style.borderLeftColor = "#d63638";
        }
        expBox.style.display = "block";
    };

    // 2. Funci√≥n FINAL (Bot√≥n rojo flotante) - CORRIGE TODO LO PENDIENTE
    window.finishExam = function() {
        clearInterval(timer);

        questions.forEach((q, index) => {
            // Si ya se corrigi√≥ individualmente, saltar
            if (userAnswers.hasOwnProperty(index)) return;

            const selected = document.querySelector(`input[name="q_${index}"]:checked`);
            
            if (selected) {
                const val = parseInt(selected.value);
                userAnswers[index] = (val === q.a);
                
                if (val !== q.a) {
                    document.getElementById(`lbl-${index}-${val}`).classList.add('wrong');
                }
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct');
            } else {
                userAnswers[index] = false; // Fallo por no responder
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct'); // Mostrar cu√°l era
            }
            
            // Bloquear visualmente
            const card = document.getElementById(`card-${index}`);
            const inputs = card.querySelectorAll('input');
            const btn = card.querySelector('.check-btn');
            inputs.forEach(inp => inp.disabled = true);
            if(btn) btn.disabled = true;
        });

        // Calcular Nota
        const totalAciertos = Object.values(userAnswers).filter(r => r === true).length;
        const totalPreguntas = questions.length;
        const notaFinal = (totalAciertos / totalPreguntas) * 10;

        // Mostrar
        document.getElementById('score-display').innerText = notaFinal.toFixed(1);
        document.getElementById('res-correct').innerText = totalAciertos;
        document.getElementById('res-wrong').innerText = totalPreguntas - totalAciertos;
        
        const msg = document.getElementById('score-msg');
        if (notaFinal >= 5) {
            msg.innerHTML = "<strong style='color:#00a32a'>¬°ENHORABUENA, HAS APROBADO! üéâ</strong>";
        } else {
            msg.innerHTML = "<strong style='color:#d63638'>HAS SUSPENDIDO. NECESITAS REPASAR. üìö</strong>";
        }

        document.getElementById('result-modal').style.display = 'flex';
    };

    // TIMER
    function startTimer() {
        timer = setInterval(() => {
            if(!isPaused) {
                timeLeft--;
                let m = Math.floor(timeLeft / 60);
                let s = timeLeft % 60;
                document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
                if(timeLeft <= 0) finishExam();
            }
        }, 1000);
    }

    window.togglePause = function() {
        isPaused = !isPaused;
        document.getElementById('pause-modal').style.display = isPaused ? 'flex' : 'none';
    };

    init();

</script>
</body>
</html>