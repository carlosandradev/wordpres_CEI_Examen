<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5.0</title>
    <style>
        :root { --primary: #2271b1; --success: #28a745; --error: #dc3545; --bg: #f0f0f1; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: #3c434a; margin: 0; padding-bottom: 100px; }
        
        .header { position: fixed; top: 0; left: 0; right: 0; background: #fff; border-bottom: 1px solid #c3c4c7; padding: 15px 20px; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .logo { font-weight: 800; color: var(--primary); font-size: 1.2rem; }
        .timer-box { font-variant-numeric: tabular-nums; font-size: 1.4rem; font-weight: 700; color: #1d2327; background: #f0f0f1; padding: 5px 15px; border-radius: 4px; }
        
        .container { max-width: 800px; margin: 90px auto 20px; padding: 0 20px; }

        .card { background: #fff; border: 1px solid #c3c4c7; padding: 25px; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .q-text { font-size: 1.1rem; font-weight: 600; margin-bottom: 20px; color: #1d2327; line-height: 1.5; }
        
        .option-label { display: flex; align-items: flex-start; gap: 12px; padding: 12px; border: 2px solid #f0f0f1; border-radius: 6px; cursor: pointer; transition: all 0.2s; margin-bottom: 10px; font-size: 0.95rem; }
        .option-label:hover { background: #f6f7f7; border-color: var(--primary); }
        .option-label input { margin-top: 3px; transform: scale(1.3); cursor: pointer; flex-shrink: 0; accent-color: var(--primary); }
        
        .fab-finish { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #d63638; color: white; padding: 15px 40px; border-radius: 50px; border: none; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(214, 54, 56, 0.4); z-index: 999; transition: transform 0.2s; white-space: nowrap; }
        .fab-finish:hover { transform: translateX(-50%) scale(1.05); background: #b32d2e; }

        /* MODAL RESULTADOS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 800px; max-height: 90vh; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        
        .modal-header { padding: 20px; background: #f9f9f9; border-bottom: 1px solid #eee; text-align: center; }
        .score-big { font-size: 2.5rem; font-weight: 800; margin: 10px 0; color: var(--primary); }
        .verdict { font-size: 1.5rem; font-weight: 700; text-transform: uppercase; margin-bottom: 10px; }
        
        .modal-body { padding: 20px; overflow-y: auto; flex-grow: 1; text-align: left; background: #f0f0f1; }
        
        .btn-restart { background: var(--primary); color: white; border: none; padding: 15px; font-size: 1.1rem; cursor: pointer; width: 100%; font-weight: bold; }
        .btn-restart:hover { background: #135e96; }

        /* REVISI√ìN DETALLADA */
        .review-item { background: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 5px solid #ccc; font-size: 0.95rem; }
        .review-item.r-correct { border-left-color: var(--success); background: #f4fff7; }
        .review-item.r-wrong { border-left-color: var(--error); background: #fff5f5; }
        
        .r-question { font-weight: bold; margin-bottom: 10px; display: block; color: #333; }
        .r-user-ans { display: block; margin-bottom: 5px; }
        .r-correct-ans { display: block; margin-bottom: 5px; color: var(--success); font-weight: 600; }
        .r-explanation { display: block; margin-top: 10px; font-style: italic; color: #666; font-size: 0.9rem; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 5px; }

        .tag-correct { color: var(--success); font-weight: bold; }
        .tag-wrong { color: var(--error); font-weight: bold; text-decoration: line-through; }

        .progress-container { position: fixed; top: 69px; left: 0; width: 100%; height: 4px; background: #e0e0e0; z-index: 998; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }
    </style>
</head>
<body>

    <div id="result-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin:0;">RESULTADO</h2>
                <div id="score-display" class="score-big">0 / 50</div>
                <div id="verdict-text" class="verdict">...</div>
                <div style="font-size:0.9rem; color:#666;">
                    ‚úÖ <span id="res-correct">0</span> | 
                    ‚ùå <span id="res-wrong">0</span>
                </div>
            </div>
            <div class="modal-body" id="detailed-review"></div>
            <button class="btn-restart" onclick="location.reload()">REPETIR EXAMEN</button>
        </div>
    </div>

    <header class="header">
        <div class="logo">EXAMEN WP AVANZADO</div>
        <div class="timer-box" id="timer">45:00</div>
    </header>
    <div class="progress-container"><div class="progress-bar" id="progress"></div></div>

    <div class="container" id="quiz-container"></div>

    <button class="fab-finish" onclick="finishExam()">FINALIZAR Y CALIFICAR</button>

<script>
    // === POOL DE PREGUNTAS EQUILIBRADAS Y DIF√çCILES ===
    const DB = [
        // --- WORDPRESS T√âCNICO Y CORE ---
        { q: "Si al migrar una web manualmente las im√°genes no cargan y los enlaces dan error, ¬øqu√© dos campos debes revisar prioritariamente en la tabla 'wp_options'?", o: ["'admin_email' y 'blogname'", "'siteurl' y 'home'", "'active_plugins' y 'template'", "'site_address' y 'wp_url'"], a: 1, e: "Son las dos URLs que definen d√≥nde busca WordPress sus archivos y enlaces." },
        { q: "¬øQu√© ocurre exactamente a nivel de servidor cuando guardas los cambios en 'Ajustes > Enlaces Permanentes'?", o: ["Se actualiza la base de datos de posts", "Se regenera el archivo .htaccess con las reglas de reescritura", "Se borra la cach√© del navegador del usuario", "Se optimizan las tablas de la base de datos"], a: 1, e: "Es la soluci√≥n est√°ndar para errores 404 porque reescribe las reglas de Apache." },
        { q: "¬øPor qu√© se recomienda desactivar 'WP_DEBUG' en un entorno de producci√≥n (web visible al p√∫blico)?", o: ["Porque ralentiza la carga de la web significativamente", "Porque podr√≠a revelar rutas del servidor y errores sensibles a los visitantes", "Porque impide que los plugins se actualicen autom√°ticamente", "Porque bloquea el acceso al panel de administraci√≥n"], a: 1, e: "Mostrar errores PHP p√∫blicamente es un riesgo de seguridad grave." },
        { q: "Si necesitas aumentar el l√≠mite de memoria PHP porque recibes un error 'Fatal Error: Allowed memory size exhausted', ¬ød√≥nde debes definir la constante 'WP_MEMORY_LIMIT'?", o: ["En el archivo functions.php del tema activo", "En el archivo wp-config.php de la ra√≠z", "En el panel de control de WooCommerce", "En el archivo footer.php del tema"], a: 1, e: "wp-config.php es el lugar correcto para alterar la configuraci√≥n de memoria de WP." },
        { q: "Al crear un Child Theme, ¬øqu√© l√≠nea es estrictamente obligatoria en el archivo style.css para que funcione?", o: ["@import url('../parent-theme/style.css');", "Template: nombre-carpeta-tema-padre", "Theme Name: Nombre del Tema Hijo", "Parent: nombre-tema-padre"], a: 1, e: "La etiqueta 'Template:' indica a WordPress de qu√© tema padre hereda los archivos." },
        { q: "¬øCu√°l es la funci√≥n principal del archivo 'functions.php' dentro de un tema de WordPress?", o: ["Definir los estilos visuales y colores de la web", "Actuar como un plugin integrado para a√±adir o modificar funcionalidades PHP", "Conectar WordPress con la base de datos MySQL", "Gestionar las redirecciones 301 del servidor"], a: 1, e: "Permite inyectar c√≥digo, crear hooks y registrar men√∫s o widgets." },
        { q: "Si un plugin provoca un error cr√≠tico y no puedes acceder al wp-admin, ¬øcu√°l es el m√©todo m√°s fiable para desactivarlo?", o: ["Borrar la base de datos y restaurar una copia", "Renombrar la carpeta del plugin a trav√©s de FTP o File Manager", "Esperar 24 horas a que el servidor se reinicie", "Intentar entrar desde una ventana de inc√≥gnito"], a: 1, e: "Al cambiar el nombre de la carpeta, WP no encuentra el plugin y lo desactiva forzosamente." },
        { q: "¬øQu√© diferencia t√©cnica existe entre 'site_url()' y 'home_url()' en WordPress?", o: ["No hay diferencia, devuelven lo mismo", "site_url es donde est√°n los archivos del core; home_url es la direcci√≥n que visita el usuario", "home_url es para el admin y site_url para el frontend", "site_url es la url de la base de datos"], a: 1, e: "Son distintos si instalas WP en un subdirectorio pero sirves la web en la ra√≠z." },
        { q: "¬øPara qu√© sirve el Nonce (Number used Once) en los formularios de WordPress?", o: ["Para evitar que se env√≠en formularios vac√≠os", "Para proteger contra ataques CSRF verificando la intenci√≥n y origen", "Para encriptar la contrase√±a del usuario", "Para contar cu√°ntas veces se ha enviado"], a: 1, e: "Es un token de seguridad temporal para validar solicitudes." },
        { q: "¬øQu√© archivo controla la jerarqu√≠a de carga si no existe 'single.php' para una entrada?", o: ["archive.php", "page.php", "singular.php (si existe) o index.php", "category.php"], a: 2, e: "WordPress busca singular.php y, en √∫ltima instancia, recurre a index.php." },

        // --- ELEMENTOR Y CSS ---
        { q: "En Elementor, si un elemento con z-index: 100 sigue apareciendo debajo de otro con z-index: 10, ¬øcu√°l es la causa m√°s probable?", o: ["El z-index est√° roto en esa versi√≥n", "El elemento padre del de z-index: 100 tiene un contexto de apilamiento inferior", "Falta a√±adir !important al CSS", "El navegador no soporta z-index"], a: 1, e: "El contexto de apilamiento (Stacking Context) del contenedor padre limita a los hijos." },
        { q: "¬øQu√© unidad CSS recomendar√≠as para textos si quieres asegurar la accesibilidad y escalabilidad relativa a la ra√≠z?", o: ["PX (P√≠xeles)", "VH (Viewport Height)", "REM (Root EM)", "PT (Puntos)"], a: 2, e: "REM es relativo al tama√±o de fuente ra√≠z del navegador, ideal para accesibilidad." },
        { q: "Si utilizas un 'Global Widget' en Elementor y lo editas en una p√°gina concreta:", o: ["Solo se cambia en esa p√°gina", "Se desvincula autom√°ticamente del global", "Se actualiza en todas las instancias de la web donde est√© ese global", "Da un error de permisos"], a: 2, e: "La gracia del Global Widget es la sincronizaci√≥n total en el sitio." },
        { q: "¬øQu√© sucede si aplicas 'Overflow: Hidden' a una secci√≥n de Elementor?", o: ["La secci√≥n se vuelve invisible", "Se oculta cualquier contenido hijo que sobresalga de los l√≠mites de la caja", "Aparece una barra de scroll dentro de la secci√≥n", "Se oculta en dispositivos m√≥viles"], a: 1, e: "Muy √∫til para evitar el scroll horizontal indeseado por animaciones." },
        { q: "¬øC√≥mo puedes aplicar estilos CSS solo a un widget espec√≠fico dentro del campo 'CSS Personalizado' de Elementor Pro?", o: ["Usando la ID del widget manualmente", "Usando la palabra clave 'selector' (ej: selector { color: red; })", "Escribiendo .elementor-widget { ... }", "No se puede, hay que ir al style.css"], a: 1, e: "'selector' es una variable din√°mica que apunta al wrapper √∫nico de ese widget." },
        { q: "Si el men√∫ desplegable m√≥vil se cierra inmediatamente al tocarlo en iOS, ¬øqu√© suele causarlo?", o: ["Un conflicto de z-index", "Un conflicto de librer√≠as JS o 'FastClick' en el tema", "El tama√±o de fuente es muy peque√±o", "El men√∫ tiene demasiados √≠tems"], a: 1, e: "Es un bug com√∫n de interacci√≥n t√°ctil en ciertos temas antiguos." },
        { q: "¬øQu√© ventaja tiene usar Contenedores Flexbox frente a las antiguas Secciones/Columnas?", o: ["Ninguna, es solo est√©tico", "Mejor rendimiento DOM (menos div anidados) y mayor control de alineaci√≥n", "Permite usar Flash", "Es m√°s f√°cil de usar para principiantes"], a: 1, e: "Reduce dr√°sticamente la cantidad de c√≥digo HTML generado." },
        { q: "Si quieres ocultar una secci√≥n en m√≥vil pero que el c√≥digo siga cargando para SEO, ¬øqu√© usas?", o: ["La opci√≥n 'Ocultar en m√≥vil' de Elementor (display: none)", "Borrar la secci√≥n en la vista m√≥vil", "Poner la opacidad a 0", "Reducir la altura a 0"], a: 0, e: "Display: none oculta visualmente pero el bot de Google sigue leyendo el contenido." },
        { q: "¬øQu√© hace la opci√≥n 'Regenerar archivos y datos' en Elementor > Herramientas?", o: ["Borra las p√°ginas creadas", "Fuerza la regeneraci√≥n de los archivos CSS externos tras cambios de estilo", "Reinicia la configuraci√≥n de Elementor", "Borra la biblioteca de medios"], a: 1, e: "Soluciona problemas cuando los cambios de dise√±o no se reflejan en el frontend." },
        { q: "Para crear una plantilla de 'Error 404' personalizada, ¬øqu√© pasos son correctos?", o: ["Crear una p√°gina llamada 404", "Theme Builder > A√±adir nueva > Error 404 > Publicar (Condici√≥n: Include 404)", "Editar el archivo 404.php por FTP", "Instalar un plugin de redirecci√≥n"], a: 1, e: "El Theme Builder inyecta la plantilla autom√°ticamente cuando detecta un error 404." },

        // --- WOOCOMMERCE AVANZADO ---
        { q: "Si vendes productos digitales y quieres evitar que el cliente pague gastos de env√≠o, ¬øqu√© configuraci√≥n es cr√≠tica?", o: ["Poner el peso a 0 kg", "Marcar el producto como 'Virtual'", "Crear una clase de env√≠o gratuita", "Usar un cup√≥n de descuento"], a: 1, e: "La casilla 'Virtual' desactiva la l√≥gica de env√≠os en el checkout." },
        { q: "Para que un cliente pueda descargar su archivo inmediatamente tras pagar con tarjeta, ¬øqu√© estado debe tener el pedido?", o: ["En espera (On Hold)", "Pendiente de pago (Pending Payment)", "Procesando (Processing) o Completado (Completed)", "Reembolsado (Refunded)"], a: 2, e: "Solo los estados de pago confirmado permiten la descarga de archivos." },
        { q: "Si deseas vender un producto con opciones de 'Talla' y 'Color' combinadas, ¬øqu√© tipo de producto debes elegir?", o: ["Producto Simple con atributos", "Producto Variable", "Producto Agrupado", "Producto Externo"], a: 1, e: "El Producto Variable permite crear una SKU distinta para cada combinaci√≥n." },
        { q: "¬øD√≥nde se almacenan t√©cnicamente los atributos globales de productos (ej: Tallas) en la base de datos?", o: ["En la tabla wp_postmeta como campos personalizados", "Como taxonom√≠as en las tablas wp_terms y wp_term_taxonomy", "En la tabla wp_options", "En una tabla propia wp_attributes"], a: 1, e: "WooCommerce usa la estructura de taxonom√≠as de WP para los atributos globales." },
        { q: "Si los correos transaccionales de WooCommerce no llegan a los clientes, ¬øcu√°l es la soluci√≥n profesional recomendada?", o: ["Usar un plugin de SMTP para autenticar el env√≠o", "Revisar la carpeta de spam del admin", "Cambiar el texto de los correos", "Desactivar y activar WooCommerce"], a: 0, e: "El env√≠o por PHP Mail() no es fiable; SMTP asegura la entrega." },
        { q: "¬øQu√© funcionalidad permite cobrar impuestos diferentes a un cliente de Canarias y a uno de Madrid?", o: ["No se puede en WooCommerce b√°sico", "La configuraci√≥n de Tarifas de Impuestos Est√°ndar por c√≥digo postal/provincia", "Crear dos productos distintos", "Usar un plugin de geolocalizaci√≥n"], a: 1, e: "Se configuran tablas de impuestos basadas en la direcci√≥n de env√≠o del cliente." },
        { q: "¬øQu√© diferencia hay entre 'Ventas Cruzadas' (Cross-sells) y 'Ventas Dirigidas' (Up-sells)?", o: ["Son lo mismo", "Up-sells en ficha (producto mejor); Cross-sells en carrito (productos complementarios)", "Cross-sells en ficha; Up-sells en checkout", "Solo existen las ventas cruzadas"], a: 1, e: "Up-sell busca elevar el ticket; Cross-sell busca a√±adir complementos." },
        { q: "Si quieres usar WooCommerce como cat√°logo (sin precios ni compra), ¬øqu√© acci√≥n t√©cnica se requiere?", o: ["Desmarcar 'Activar compras' en ajustes", "Usar un hook para `remove_action` del bot√≥n 'add_to_cart'", "Poner el stock a 0", "Borrar la p√°gina de carrito"], a: 1, e: "WooCommerce no tiene 'Modo Cat√°logo' nativo; se hace por c√≥digo o plugin." },
        { q: "¬øQu√© sucede si borras un pedido que estaba en estado 'Completado'?", o: ["El dinero se devuelve autom√°ticamente", "Se eliminan los datos pero las estad√≠sticas de ventas no cambian", "Se eliminan los datos y se restan los importes de los informes de ventas", "No se pueden borrar pedidos completados"], a: 2, e: "WooCommerce recalcula los informes financieros al eliminar registros." },
        { q: "Para vender entradas de eventos con fecha y aforo limitado, ¬øes suficiente con WooCommerce est√°ndar?", o: ["S√≠, usando productos variables", "No, se recomienda una extensi√≥n de 'Bookings' o 'Events'", "S√≠, usando productos virtuales", "S√≠, usando el campo de notas"], a: 1, e: "El control de fechas, horarios y aforo requiere l√≥gica extra que el core no tiene." },

        // --- OPTIMIZACI√ìN Y SEGURIDAD ---
        { q: "¬øQu√© hace la directiva 'Disallow: /wp-admin/' en el archivo robots.txt?", o: ["Bloquea el acceso de los hackers al admin", "Indica a los bots de b√∫squeda que no rastreen ni indexen esa carpeta", "Borra la carpeta wp-admin", "Redirige a la home"], a: 1, e: "Es una instrucci√≥n de rastreo, no de seguridad de acceso." },
        { q: "Si usas un plugin de cach√© de objetos (Object Cache) como Redis, ¬øqu√© est√°s optimizando?", o: ["La carga de im√°genes", "Las consultas repetitivas a la base de datos", "El c√≥digo CSS y JS", "La velocidad de descarga de archivos"], a: 1, e: "Almacena en memoria los resultados de consultas SQL para no repetirlas." },
        { q: "¬øQu√© cabecera de seguridad HTTP ayuda a prevenir ataques XSS (Cross-Site Scripting)?", o: ["Strict-Transport-Security", "Content-Security-Policy (CSP)", "X-Frame-Options", "Referrer-Policy"], a: 1, e: "CSP define qu√© fuentes de contenido son v√°lidas para cargar en la web." },
        { q: "Si tienes contenido mixto (Mixed Content) tras instalar SSL, ¬øqu√© significa?", o: ["Que tienes posts y p√°ginas mezclados", "Que la web carga por HTTPS pero solicita recursos (img/script) por HTTP", "Que el certificado ha caducado", "Que hay dos certificados instalados"], a: 1, e: "El navegador bloquea o avisa de que la conexi√≥n no es totalmente segura." },
        { q: "¬øQu√© es el 'Heartbeat API' de WordPress y por qu√© a veces se limita?", o: ["Es un plugin de salud", "Es el protocolo de comunicaci√≥n continua navegador-servidor que puede saturar la CPU", "Es el sistema de likes", "Es el cron de WordPress"], a: 1, e: "El autoguardado y notificaciones en tiempo real consumen muchos recursos." },
        { q: "Para proteger el formulario de login contra fuerza bruta, ¬øqu√© medida es m√°s efectiva?", o: ["Cambiar el color del bot√≥n", "Limitar el n√∫mero de intentos de inicio de sesi√≥n fallidos", "Hacer la contrase√±a obligatoria", "Usar el usuario 'admin'"], a: 1, e: "Bloquear la IP tras 3-5 fallos frena los bots de diccionario." },
        { q: "¬øQu√© ventaja principal ofrece el formato de imagen WebP frente a JPG/PNG?", o: ["Soporta animaci√≥n", "Ofrece una compresi√≥n superior con menor p√©rdida de calidad y transparencia", "Es vectorial", "Lo leen los servidores antiguos"], a: 1, e: "Es el est√°ndar moderno de Google para velocidad web." },
        { q: "¬øQu√© es el Lazy Load nativo del navegador (loading='lazy')?", o: ["Un script de JS pesado", "Un atributo HTML que difiere la carga de im√°genes off-screen sin usar JS", "Un error de carga", "Un plugin de cach√©"], a: 1, e: "Ahora el navegador gestiona la carga diferida sin necesidad de librer√≠as externas." },
        { q: "Si necesitas editar el archivo .htaccess pero no tienes acceso FTP, ¬øqu√© plugin te ayudar√≠a?", o: ["Yoast SEO (Herramientas)", "Contact Form 7", "Classic Editor", "Elementor"], a: 0, e: "Yoast incluye un editor de archivos para .htaccess y robots.txt." },
        { q: "¬øPor qu√© no se debe usar el usuario 'admin' por defecto?", o: ["Porque es feo", "Porque es el primer usuario que intentan atacar los bots (mitad del trabajo hecho)", "Porque no tiene permisos", "Porque WP no lo permite"], a: 1, e: "Usar un nombre de usuario √∫nico dificulta el ataque de fuerza bruta." },

        // --- GENERAL Y CASOS REALES ---
        { q: "Si un cliente te pide una web multiidioma con traducci√≥n manual, ¬øqu√© plugin es el est√°ndar?", o: ["Google Translate", "WPML o Polylang", "Loco Translate", "WooCommerce"], a: 1, e: "Son los gestores de contenido multiling√ºe m√°s robustos." },
        { q: "¬øQu√© etiqueta HTML es fundamental para que el dise√±o responsive funcione en m√≥viles?", o: ["<meta name='viewport' content='width=device-width...'>", "<meta charset='UTF-8'>", "<link rel='stylesheet'>", "<title>"], a: 0, e: "Sin el viewport, el m√≥vil renderiza la web como si fuera de escritorio (zoom out)." },
        { q: "Si activas 'Disuadir a los motores de b√∫squeda' en Ajustes, ¬øqu√© etiqueta se a√±ade al c√≥digo?", o: ["<meta name='robots' content='noindex,nofollow' />", "<meta name='google' content='no' />", "Disallow: /", "Noindex: true"], a: 0, e: "La metaetiqueta 'noindex' es la directiva que obedece Google." },
        { q: "¬øQu√© es un 'Child Theme' y cu√°ndo es obligatorio usarlo?", o: ["Siempre que instales WordPress", "Cuando vayas a modificar archivos de c√≥digo (PHP/CSS) del tema para no perderlos al actualizar", "Solo en tiendas online", "Cuando usas Elementor"], a: 1, e: "Es la √∫nica forma segura de personalizar la l√≥gica del tema." },
        { q: "Si aparece el 'Pantallazo Blanco de la Muerte' (WSOD), ¬øcu√°l es el primer paso para diagnosticar?", o: ["Reinstalar todo", "Activar WP_DEBUG o revisar el archivo error_log del servidor", "Cambiar de hosting", "Borrar el tema"], a: 1, e: "Necesitas ver el mensaje de error para saber qu√© plugin o archivo fall√≥." },
        { q: "¬øQu√© es el 'Canonical URL' y para qu√© sirve en SEO?", o: ["Es la URL de la home", "Indica a Google cu√°l es la versi√≥n original de una p√°gina para evitar contenido duplicado", "Es una redirecci√≥n 301", "Es un enlace roto"], a: 1, e: "Evita penalizaciones si un mismo contenido es accesible desde varias URLs." },
        { q: "¬øPara qu√© sirve la herramienta 'Salud del Sitio' (Site Health) en Herramientas?", o: ["Para limpiar virus", "Para diagnosticar problemas de configuraci√≥n, versiones de PHP y extensiones faltantes", "Para hacer backups", "Para medir visitas"], a: 1, e: "Ofrece un informe t√©cnico del estado de la instalaci√≥n." },
        { q: "Si quieres incrustar un v√≠deo de YouTube sin que afecte mucho al rendimiento, ¬øqu√© t√©cnica usas?", o: ["Subirlo a la biblioteca de medios", "Usar una fachada (imagen de carga) que solo carga el iframe al hacer clic", "Poner el enlace y ya", "Usar un GIF"], a: 1, e: "Cargar el iframe de YouTube en el inicio bloquea la carga; la fachada lo evita." },
        { q: "¬øQu√© diferencia hay entre una 'Redirecci√≥n 301' y una '302'?", o: ["No hay diferencia", "301 es Permanente (traspasa fuerza SEO), 302 es Temporal (no traspasa)", "301 es para errores, 302 para aciertos", "302 es m√°s r√°pida"], a: 1, e: "Para cambios definitivos de URL siempre se usa 301." },
        { q: "Si el cron de WordPress (WP-Cron) falla o ralentiza la web, ¬øqu√© se recomienda?", o: ["Desactivarlo en wp-config.php y configurar un cron real en el panel del hosting", "Borrarlo", "Instalar un plugin de cron", "No hacer nada"], a: 0, e: "El cron real es m√°s preciso y no depende de que haya visitas en la web." }
    ];

    // ======================================================
    // L√ìGICA DEL EXAMEN
    // ======================================================

    let questions = []; 
    let timer;
    let timeLeft = 45 * 60; 

    function init() {
        if(typeof DB === 'undefined') return alert("‚ö†Ô∏è ERROR: No has pegado las preguntas.");
        
        // Seleccionar 50 aleatorias
        questions = DB.sort(() => 0.5 - Math.random()).slice(0, 50);
        
        const container = document.getElementById('quiz-container');
        container.innerHTML = ""; 
        
        questions.forEach((q, index) => {
            let html = `
                <div class="card" id="card-${index}">
                    <div class="q-text"><span style="color:#2271b1; font-weight:800;">#${index + 1}</span> ${q.q}</div>
                    <div class="options-group">
            `;
            
            // Barajar opciones visualmente
            let indices = q.o.map((_, i) => i);
            indices.sort(() => 0.5 - Math.random());

            indices.forEach(i => {
                html += `
                    <label class="option-label" id="lbl-${index}-${i}">
                        <input type="radio" name="q_${index}" value="${i}">
                        ${q.o[i]}
                    </label>
                `;
            });

            html += `</div>
                     <div class="explanation-box" id="exp-${index}"></div>
                     </div>`;
            container.innerHTML += html;
        });

        startTimer();
        
        // Barra de progreso
        document.querySelectorAll('input').forEach(i => {
            i.addEventListener('change', () => {
                const answered = document.querySelectorAll('input:checked').length;
                document.getElementById('progress').style.width = `${(answered/50)*100}%`;
            });
        });
    }

    window.finishExam = function() {
        clearInterval(timer);
        
        let correctCount = 0;
        let reviewHTML = "";

        // Recorremos las 50 preguntas
        questions.forEach((q, index) => {
            const card = document.getElementById(`card-${index}`);
            const expBox = document.getElementById(`exp-${index}`);
            const selected = document.querySelector(`input[name="q_${index}"]:checked`);
            
            let userVal = selected ? parseInt(selected.value) : -1; 
            let isCorrect = (userVal === q.a);
            
            // Bloquear inputs
            card.querySelectorAll('input').forEach(i => i.disabled = true);

            // LOGICA VISUAL DETALLADA
            if (isCorrect) {
                correctCount++;
                card.classList.add('correct-card');
                document.getElementById(`lbl-${index}-${userVal}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚úÖ ¬°CORRECTO!</strong>${q.e}`;
                
                // Add to modal review
                reviewHTML += `<div class="review-item r-correct"><b>${index+1}. Acierto</b><br>Tu respuesta: ${q.o[userVal]}</div>`;
            
            } else if (userVal !== -1) {
                // Fall√≥
                card.classList.add('wrong-card');
                document.getElementById(`lbl-${index}-${userVal}`).classList.add('user-wrong');
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚ùå FALLO</strong><br>La correcta era: <b>${q.o[q.a]}</b><br><em>${q.e}</em>`;
                
                reviewHTML += `<div class="review-item r-wrong"><b>${index+1}. Fallo</b><br>Tu respuesta: ${q.o[userVal]}<br>Correcta: <strong>${q.o[q.a]}</strong></div>`;
            
            } else {
                // En blanco
                card.classList.add('wrong-card');
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚ö™ EN BLANCO</strong><br>La correcta era: <b>${q.o[q.a]}</b><br><em>${q.e}</em>`;
                
                reviewHTML += `<div class="review-item r-wrong"><b>${index+1}. En blanco</b><br>Correcta: <strong>${q.o[q.a]}</strong></div>`;
            }
            
            expBox.style.display = 'block';
        });

        // BAREMO CEI
        let verdict = "";
        let color = "";

        if (correctCount >= 45) { // 45-50
            verdict = "SOBRESALIENTE üèÜ";
            color = "#28a745";
        } else if (correctCount >= 40) { // 40-44
            verdict = "NOTABLE üåü";
            color = "#17a2b8";
        } else if (correctCount >= 35) { // 35-39
            verdict = "BIEN üëç";
            color = "#2271b1";
        } else if (correctCount >= 30) { // 30-34
            verdict = "APTO üëå";
            color = "#fd7e14";
        } else {
            verdict = "NO APTO ‚ùå";
            color = "#dc3545";
        }

        // PINTAR MODAL
        document.getElementById('score-display').innerText = `${correctCount} / 50`;
        document.getElementById('score-display').style.color = color;
        
        const vText = document.getElementById('verdict-text');
        vText.innerText = verdict;
        vText.style.color = color;

        document.getElementById('res-correct').innerText = correctCount;
        document.getElementById('res-wrong').innerText = 50 - correctCount;

        document.getElementById('detailed-review').innerHTML = reviewHTML;
        document.getElementById('result-modal').style.display = 'flex';
    };

    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            let m = Math.floor(timeLeft / 60);
            let s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if(timeLeft <= 0) finishExam();
        }, 1000);
    }

    window.onload = function() {
        if(typeof DB !== 'undefined') init();
    };

</script>
</body>
</html>