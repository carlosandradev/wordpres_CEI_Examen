<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9.0</title>
    <style>
        :root { --primary: #2271b1; --success: #28a745; --error: #dc3545; --bg: #f0f0f1; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: #3c434a; margin: 0; padding-bottom: 100px; }
        
        .header { position: fixed; top: 0; left: 0; right: 0; background: #fff; border-bottom: 1px solid #c3c4c7; padding: 15px 20px; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .logo { font-weight: 800; color: var(--primary); font-size: 1.2rem; }
        .timer-box { font-variant-numeric: tabular-nums; font-size: 1.4rem; font-weight: 700; color: #1d2327; background: #f0f0f1; padding: 5px 15px; border-radius: 4px; }
        
        .container { max-width: 800px; margin: 90px auto 20px; padding: 0 20px; }

        .card { background: #fff; border: 1px solid #c3c4c7; padding: 25px; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .q-text { font-size: 1.1rem; font-weight: 600; margin-bottom: 20px; color: #1d2327; line-height: 1.5; }
        
        .option-label { display: flex; align-items: flex-start; gap: 12px; padding: 12px; border: 2px solid #f0f0f1; border-radius: 6px; cursor: pointer; transition: all 0.2s; margin-bottom: 10px; font-size: 0.95rem; }
        .option-label:hover { background: #f6f7f7; border-color: var(--primary); }
        .option-label input { margin-top: 3px; transform: scale(1.3); cursor: pointer; flex-shrink: 0; accent-color: var(--primary); }
        
        .fab-finish { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #d63638; color: white; padding: 15px 40px; border-radius: 50px; border: none; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(214, 54, 56, 0.4); z-index: 999; transition: transform 0.2s; white-space: nowrap; }
        .fab-finish:hover { transform: translateX(-50%) scale(1.05); background: #b32d2e; }

        /* MODAL RESULTADOS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 800px; max-height: 90vh; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        
        .modal-header { padding: 20px; background: #f9f9f9; border-bottom: 1px solid #eee; text-align: center; }
        .score-big { font-size: 2.5rem; font-weight: 800; margin: 10px 0; color: var(--primary); }
        .verdict { font-size: 1.5rem; font-weight: 700; text-transform: uppercase; margin-bottom: 10px; }
        
        .modal-body { padding: 20px; overflow-y: auto; flex-grow: 1; text-align: left; background: #f0f0f1; }
        
        .btn-restart { background: var(--primary); color: white; border: none; padding: 15px; font-size: 1.1rem; cursor: pointer; width: 100%; font-weight: bold; }
        .btn-restart:hover { background: #135e96; }

        /* REVISI√ìN DETALLADA */
        .review-item { background: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 5px solid #ccc; font-size: 0.95rem; }
        .review-item.r-correct { border-left-color: var(--success); background: #f4fff7; }
        .review-item.r-wrong { border-left-color: var(--error); background: #fff5f5; }
        
        .r-question { font-weight: bold; margin-bottom: 10px; display: block; color: #333; }
        .r-user-ans { display: block; margin-bottom: 5px; }
        .r-correct-ans { display: block; margin-bottom: 5px; color: var(--success); font-weight: 600; }
        .r-explanation { display: block; margin-top: 10px; font-style: italic; color: #666; font-size: 0.9rem; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 5px; }

        .tag-correct { color: var(--success); font-weight: bold; }
        .tag-wrong { color: var(--error); font-weight: bold; text-decoration: line-through; }

        .progress-container { position: fixed; top: 69px; left: 0; width: 100%; height: 4px; background: #e0e0e0; z-index: 998; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }

        .explanation-box { display: none; margin-top: 15px; padding: 12px; background: #f9f9f9; border-left: 4px solid #ccc; border-radius: 4px; font-size: 0.9rem; color: #555; }
        .correct-card .explanation-box { border-left-color: var(--success); background: #f4fff7; }
        .wrong-card .explanation-box { border-left-color: var(--error); background: #fff5f5; }
        .correct-answer { background: #d4edda !important; border-color: var(--success) !important; }
        .user-wrong { background: #f8d7da !important; border-color: var(--error) !important; }
        .options-group { display: flex; flex-direction: column; }
    </style>
</head>
<body>

    <div id="result-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin:0;">RESULTADO</h2>
                <div id="score-display" class="score-big">0 / 50</div>
                <div id="verdict-text" class="verdict">...</div>
                <div style="font-size:0.9rem; color:#666;">
                    ‚úÖ <span id="res-correct">0</span> | 
                    ‚ùå <span id="res-wrong">0</span>
                </div>
            </div>
            <div class="modal-body" id="detailed-review"></div>
            <button class="btn-restart" onclick="location.reload()">REPETIR EXAMEN</button>
        </div>
    </div>

    <header class="header">
        <div class="logo">EXAMEN WP AVANZADO</div>
        <div class="timer-box" id="timer">45:00</div>
    </header>
    <div class="progress-container"><div class="progress-bar" id="progress"></div></div>

    <div class="container" id="quiz-container"></div>

    <button class="fab-finish" onclick="finishExam()">FINALIZAR Y CALIFICAR</button>

<script>
  const DB = [
        // --- BLOQUE 1: CORE DE WORDPRESS Y ARCHIVOS ---
        { q: "¬øQu√© archivo debes editar si necesitas aumentar manualmente el l√≠mite de memoria PHP (WP_MEMORY_LIMIT)?", o: ["El archivo .htaccess de la ra√≠z", "El archivo wp-config.php", "El archivo functions.php del tema", "El archivo style.css"], a: 1, e: "Es una constante de configuraci√≥n global que se define en wp-config.php." },
        { q: "Si los enlaces internos dan error 404 tras una migraci√≥n, ¬øqu√© acci√≥n regenera el archivo .htaccess para solucionarlo?", o: ["Reinstalar el n√∫cleo de WordPress", "Cambiar el tema a uno por defecto", "Guardar cambios en Ajustes > Enlaces permanentes", "Desactivar todos los plugins"], a: 2, e: "Al guardar, WordPress reescribe las reglas de ruta (rewrite rules) en el servidor." },
        { q: "¬øCu√°l es la funci√≥n t√©cnica fundamental de un Tema Hijo (Child Theme) en desarrollo?", o: ["Mejorar la velocidad de carga de la web", "Preservar las modificaciones de c√≥digo tras actualizar el tema padre", "A√±adir nuevas funcionalidades al panel de administraci√≥n", "Crear copias de seguridad autom√°ticas del dise√±o"], a: 1, e: "Evita que al actualizar el tema padre se sobrescriban tus cambios en functions.php o style.css." },
        { q: "¬øQu√© sucede visualmente si desactivas un plugin que generaba 'Shortcodes' en tus p√°ginas?", o: ["El contenido del shortcode se muestra como texto plano entre corchetes", "La p√°gina web deja de cargar y muestra un error 500", "WordPress oculta autom√°ticamente el c√≥digo roto", "El contenido se mantiene pero pierde el estilo CSS"], a: 0, e: "Al no existir la funci√≥n que procesa el shortcode, WordPress lo trata como texto normal (ej: [galeria])." },
        { q: "¬øPara qu√© se utiliza la constante 'WP_DEBUG' configurada a 'true'?", o: ["Para bloquear ataques de fuerza bruta en el login", "Para mostrar errores, avisos y advertencias de PHP en pantalla", "Para optimizar las tablas de la base de datos", "Para poner la web en modo mantenimiento para usuarios"], a: 1, e: "Es una herramienta de desarrollo para depurar c√≥digo, no debe usarse en producci√≥n." },
        { q: "En la jerarqu√≠a de plantillas, ¬øqu√© archivo busca WordPress con prioridad para mostrar una entrada individual?", o: ["index.php", "page.php", "single.php", "archive.php"], a: 2, e: "WordPress busca 'single.php'. Si no existe, busca 'singular.php' y finalmente 'index.php'." },
        { q: "¬øEn qu√© tabla de la base de datos se almacenan las URLs cr√≠ticas 'siteurl' y 'home'?", o: ["En la tabla wp_posts", "En la tabla wp_options", "En la tabla wp_users", "En la tabla wp_meta"], a: 1, e: "Son campos vitales; si est√°n incorrectos, la web no cargar√° los estilos ni enlaces." },
        { q: "¬øQu√© diferencia t√©cnica estructural existe entre una Categor√≠a y una Etiqueta?", o: ["Las Categor√≠as permiten jerarqu√≠a (padre/hijo); las Etiquetas son planas", "Las Etiquetas son obligatorias; las Categor√≠as son opcionales", "Las Categor√≠as son para p√°ginas; las Etiquetas para entradas", "No hay diferencia t√©cnica, solo visual en el tema"], a: 0, e: "La jerarqu√≠a permite anidar contenidos (ej: Ropa > Mujer), las etiquetas no." },
        { q: "¬øQu√© capacidad exclusiva tiene el rol de Administrador frente al de Editor?", o: ["Puede publicar y editar entradas de otros", "Puede moderar comentarios de los usuarios", "Puede instalar plugins, temas y crear usuarios", "Puede subir archivos a la biblioteca de medios"], a: 2, e: "El Editor gestiona contenido; solo el Admin gestiona la configuraci√≥n t√©cnica del sistema." },
        { q: "Si deseas que la p√°gina de inicio NO muestre el blog, ¬ød√≥nde realizas el ajuste?", o: ["Ajustes > Generales > P√°gina principal", "Apariencia > Personalizar > Blog", "Ajustes > Lectura > Una p√°gina est√°tica", "Entradas > Configuraci√≥n de visibilidad"], a: 2, e: "Debes asignar una p√°gina concreta como 'Portada' y otra p√°gina vac√≠a como 'P√°gina de Entradas'." },

        // --- BLOQUE 2: ELEMENTOR Y MAQUETACI√ìN ---
        { q: "¬øQu√© propiedad CSS se debe ajustar si dos secciones 'Sticky' se solapan incorrectamente al hacer scroll?", o: ["Padding Superior", "Margin Inferior", "Z-Index", "Opacity"], a: 2, e: "El Z-Index controla el apilamiento; el elemento con mayor n√∫mero se ver√° por encima." },
        { q: "¬øQu√© funci√≥n cumple la herramienta 'Regenerar CSS y Datos' de Elementor?", o: ["Borra todos los estilos personalizados del sitio", "Limpia la cach√© de estilos y regenera los archivos CSS externos", "Restaura la configuraci√≥n de f√°brica del plugin", "Actualiza la versi√≥n de Elementor a la √∫ltima"], a: 1, e: "Es la soluci√≥n principal cuando los cambios hechos en el editor no se reflejan en la web p√∫blica." },
        { q: "Para que una secci√≥n ocupe siempre el 100% de la altura de la pantalla del dispositivo, ¬øqu√© unidad usas?", o: ["Altura m√≠nima: 1000 PX", "Altura m√≠nima: 100 VH (Viewport Height)", "Relleno: 100%", "Margen: Auto"], a: 1, e: "VH es una unidad relativa que se adapta din√°micamente al tama√±o de la ventana del navegador." },
        { q: "¬øCu√°l es la utilidad principal del 'Navegador' (Navigator) en la interfaz de Elementor?", o: ["Previsualizar la web en distintos navegadores", "Acceder y reordenar capas o elementos dif√≠ciles de seleccionar", "Buscar widgets en el panel lateral", "Ver el historial de revisiones y cambios"], a: 1, e: "Permite seleccionar elementos con posici√≥n absoluta o z-index negativo que no se pueden clicar." },
        { q: "¬øC√≥mo se evita que un ancla de men√∫ quede oculta bajo la cabecera fija al hacer clic?", o: ["A√±adiendo margen superior a la secci√≥n destino", "Usando la opci√≥n 'Desplazamiento de ancla' (Offset)", "Reduciendo la altura del men√∫ de navegaci√≥n", "Cambiando el men√∫ a posici√≥n est√°tica"], a: 1, e: "El offset (desplazamiento) compensa la altura de la cabecera fija para que el contenido sea visible." },
        { q: "¬øQu√© ventaja principal ofrece el uso de 'Colores Globales' en el dise√±o web?", o: ["Permiten usar m√°s colores que la paleta est√°ndar", "Si modificas un color global, se actualiza en toda la web a la vez", "Son colores que cargan m√°s r√°pido en el navegador", "Permiten usar degradados complejos"], a: 1, e: "Facilita el mantenimiento y asegura la consistencia de la identidad visual." },
        { q: "Para reutilizar un dise√±o de bloque en varias p√°ginas y editarlo desde un √∫nico lugar, utilizas:", o: ["Una plantilla de p√°gina completa", "Un Widget Global (Global Widget)", "Un bloque HTML est√°ndar", "Un shortcode manual en functions.php"], a: 1, e: "El Widget Global mantiene sincronizados el contenido y el estilo en todas sus instancias." },
        { q: "¬øQu√© consecuencia tiene desactivar Elementor Pro manteniendo la versi√≥n gratuita?", o: ["Se borra todo el contenido maquetado con Elementor", "Desaparecen las funciones Pro (Theme Builder, Forms...), pero el contenido b√°sico se mantiene", "La web muestra un error fatal y no carga", "No ocurre nada, todo sigue igual"], a: 1, e: "Se pierde el dise√±o de cabeceras/pies y widgets avanzados, pero el texto/im√°genes b√°sicos suelen quedar." },
        { q: "En el Theme Builder, ¬øc√≥mo aplicas una plantilla solo a los posts de la categor√≠a 'Noticias'?", o: ["Singular > Entradas", "Archivo > Categor√≠as", "Include > En Categor√≠a > Noticias", "Todo el sitio"], a: 2, e: "Debes usar una condici√≥n de visualizaci√≥n (Display Condition) espec√≠fica para esa taxonom√≠a." },
        { q: "¬øPara qu√© sirve configurar los 'Puntos de Ruptura' (Breakpoints) en Elementor?", o: ["Para reiniciar el dise√±o a cero", "Para definir el ancho en p√≠xeles donde cambia el dise√±o a Tablet o M√≥vil", "Para eliminar secciones en la vista m√≥vil", "Para separar columnas autom√°ticamente"], a: 1, e: "Permite controlar con precisi√≥n en qu√© ancho de pantalla salta el dise√±o adaptativo." },

        // --- BLOQUE 3: WOOCOMMERCE ---
        { q: "Si vendes un servicio o archivo digital sin env√≠o f√≠sico, ¬øqu√© marcas en el producto?", o: ["Virtual", "Descargable", "Gesti√≥n de inventario", "Env√≠o gratuito"], a: 0, e: "La opci√≥n 'Virtual' desactiva el c√°lculo de env√≠o y la petici√≥n de direcci√≥n en el checkout." },
        { q: "¬øQu√© paso es obligatorio antes de poder generar variaciones en un Producto Variable?", o: ["Subir todas las im√°genes a la galer√≠a", "Crear los Atributos y marcar 'Usado para variaciones'", "Establecer un precio de oferta", "Activar el control de stock"], a: 1, e: "Sin atributos definidos (ej: Talla) y vinculados, WooCommerce no puede generar las combinaciones." },
        { q: "¬øD√≥nde se personalizan los colores y textos de los correos autom√°ticos de WooCommerce?", o: ["En Apariencia > Personalizar", "En WooCommerce > Ajustes > Correos electr√≥nicos", "En el archivo functions.php", "En el servidor de correo"], a: 1, e: "Es el panel nativo para gestionar las notificaciones transaccionales." },
        { q: "¬øQu√© tipo de producto permite vender un conjunto de √≠tems que el usuario puede elegir por separado?", o: ["Producto Variable", "Producto Agrupado", "Producto Externo", "Producto Simple"], a: 1, e: "El producto agrupado act√∫a como contenedor de varios productos simples." },
        { q: "Si los correos de la tienda no llegan, ¬øcu√°l es la soluci√≥n t√©cnica recomendada?", o: ["Reinstalar WooCommerce", "Configurar un plugin de SMTP para env√≠o autenticado", "Pedir al cliente que revise spam", "Cambiar el dise√±o del correo"], a: 1, e: "El env√≠o PHP Mail() por defecto falla a menudo; SMTP garantiza la entrega." },
        { q: "¬øC√≥mo se configuran costes de env√≠o distintos para Pen√≠nsula y Canarias?", o: ["No es posible sin plugins de pago", "Creando Zonas de Env√≠o distintas por c√≥digo postal/provincia", "Usando cupones de descuento", "Pidiendo al cliente que elija su tarifa"], a: 1, e: "Las Zonas de Env√≠o permiten asignar m√©todos y precios seg√∫n la geograf√≠a del cliente." },
        { q: "¬øQu√© estado de pedido indica que el pago se ha cobrado correctamente?", o: ["Pendiente de pago", "En espera", "Procesando", "Completado"], a: 2, e: "'Procesando' significa cobro exitoso y stock descontado. 'Completado' es cuando ya se envi√≥." },
        { q: "Para usar WooCommerce como cat√°logo sin venta, ¬øqu√© acci√≥n es necesaria?", o: ["Desactivar la pasarela de pago", "Ocultar el bot√≥n 'A√±adir al carrito' y precios (c√≥digo/plugin)", "Poner el stock a cero", "Borrar la p√°gina de carrito"], a: 1, e: "No existe un modo cat√°logo nativo; se logra ocultando la posibilidad de comprar." },
        { q: "¬øQu√© permite la 'Gesti√≥n de inventario' a nivel de producto?", o: ["Mostrar si hay stock o no", "Definir cantidad exacta y descontarla autom√°ticamente al vender", "Cambiar el precio seg√∫n demanda", "Reservar productos en el carrito"], a: 1, e: "Controla las unidades reales para evitar vender m√°s de lo que tienes." },
        { q: "¬øWooCommerce genera facturas legales en PDF por defecto?", o: ["S√≠, se adjuntan al email", "No, se requiere un plugin de facturas PDF", "S√≠, en Ajustes > Impuestos", "Solo en la versi√≥n de pago"], a: 1, e: "Nativamente solo env√≠a recibos por email; para facturas PDF necesitas un plugin extra." },

        // --- BLOQUE 4: OPTIMIZACI√ìN Y SEGURIDAD ---
        { q: "¬øQu√© funci√≥n t√©cnica realiza el 'Lazy Load' en las im√°genes?", o: ["Comprimirlas al subir", "Diferir su carga hasta que el usuario hace scroll hacia ellas", "Reducir su calidad en m√≥viles", "Eliminar metadatos EXIF"], a: 1, e: "Mejora el tiempo de carga inicial (WPO) al no descargar recursos que no est√°n visibles." },
        { q: "Un 'Error HTTP' al subir im√°genes suele indicar:", o: ["Formato incorrecto", "Falta de memoria en el servidor o dimensiones excesivas", "Nombre de archivo largo", "Biblioteca llena"], a: 1, e: "El servidor agota recursos (RAM/Tiempo) procesando la imagen." },
        { q: "¬øCu√°l es la funci√≥n de un plugin de cach√© de p√°gina?", o: ["Limpiar la base de datos", "Generar archivos HTML est√°ticos para evitar consultas PHP/SQL", "Optimizar im√°genes", "Bloquear virus"], a: 1, e: "Sirve una copia 'prefabricada' de la web, reduciendo dr√°sticamente la carga del servidor." },
        { q: "¬øPor qu√© cambiar el prefijo 'wp_' de la base de datos es una medida de seguridad?", o: ["Mejora la velocidad", "Dificulta ataques de inyecci√≥n SQL a tablas con nombres predecibles", "Permite m√°s plugins", "Es requisito de instalaci√≥n"], a: 1, e: "Seguridad por oscuridad: evita que los bots sepan autom√°ticamente c√≥mo se llaman tus tablas." },
        { q: "Ante una 'Pantalla Blanca' (WSOD) por un plugin defectuoso, ¬øc√≥mo recuperas acceso?", o: ["Borrando la base de datos", "Renombrando la carpeta del plugin v√≠a FTP/Hosting", "Esperando reinicio", "Reinstalando WP"], a: 1, e: "Al cambiar el nombre, WordPress no encuentra el plugin y lo desactiva forzosamente." },
        { q: "¬øQu√© controla el archivo robots.txt?", o: ["Seguridad del admin", "Instrucciones de rastreo (allow/disallow) para los bots", "Redirecciones 301", "Conexi√≥n a la base de datos"], a: 1, e: "Indica a los buscadores qu√© partes de la web pueden o no pueden escanear." },
        { q: "¬øQu√© es el 'Contenido Mixto' en una web con SSL (HTTPS)?", o: ["Varios idiomas mezclados", "Carga de recursos HTTP inseguros en una p√°gina HTTPS", "Enlaces rotos", "P√°ginas y posts mezclados"], a: 1, e: "Rompe la seguridad del candado verde; todos los recursos (im√°genes/scripts) deben ser HTTPS." },
        { q: "¬øQu√© plugin es el est√°ndar del curso para realizar migraciones completas?", o: ["Yoast SEO", "All-in-One WP Migration o Duplicator", "Jetpack", "W3 Total Cache"], a: 1, e: "Empaquetan archivos y base de datos en un solo archivo instalable." },
        { q: "Seg√∫n RGPD, el checkbox de privacidad en formularios debe estar:", o: ["Marcado por defecto", "Desmarcado y ser obligatorio para enviar", "Visible pero opcional", "Oculto"], a: 1, e: "Requiere una acci√≥n afirmativa y consciente del usuario (Consentimiento Expreso)." },
        { q: "¬øQu√© herramienta externa se recomienda para optimizar im√°genes antes de subir?", o: ["Photoshop", "Squoosh.app o TinyPNG", "Editor de WordPress", "Paint"], a: 1, e: "Optimizar antes de subir es mejor pr√°ctica que depender de la compresi√≥n del servidor." },

        // --- BLOQUE 5: GENERAL Y CONCEPTOS T√âCNICOS ---
        { q: "¬øCu√°ndo se debe usar un 'Custom Post Type' (CPT)?", o: ["Para cambiar el dise√±o", "Para gestionar contenidos con estructura propia (ej: Inmuebles)", "Para usar WooCommerce", "Para p√°ginas de contacto"], a: 1, e: "Separa sem√°nticamente contenidos que no encajan en la l√≥gica de Blog o P√°gina." },
        { q: "¬øCu√°l es la mejor pr√°ctica para a√±adir el c√≥digo de Google Analytics?", o: ["Pegarlo en cada post", "Usar un plugin de 'Code Snippets' o un Child Theme", "Editar el index.php", "En CSS adicional"], a: 1, e: "Nunca editar el tema padre directamente, ya que se perder√° al actualizar." },
        { q: "¬øQu√© implica la filosof√≠a 'Mobile First' en desarrollo?", o: ["Solo m√≥vil", "Priorizar estructura/dise√±o para pantallas peque√±as y escalar", "Google ignora PC", "Usar Apps"], a: 1, e: "Es el est√°ndar actual de Google para indexaci√≥n y usabilidad." },
        { q: "¬øPara qu√© sirve el atributo 'alt' en las im√°genes?", o: ["Mostrar t√≠tulo", "Accesibilidad (lectores pantalla) y SEO", "Poner borde", "Reducir peso"], a: 1, e: "Describe la imagen a m√°quinas y personas con discapacidad visual." },
        { q: "¬øQu√© plugin es est√°ndar para webs multiidioma?", o: ["WooCommerce", "WPML o Polylang", "Yoast SEO", "Elementor"], a: 1, e: "Gestionan traducciones y relaciones entre contenidos." },
        { q: "¬øQu√© es un 'Breadcrumb' (Miga de pan)?", o: ["Men√∫ footer", "Rastro de navegaci√≥n que ubica al usuario", "Error de carga", "Cookie"], a: 1, e: "Mejora UX y estructura de enlaces internos." },
        { q: "Diferencia entre Hosting y Dominio:", o: ["Lo mismo", "Hosting = Alojamiento (archivos); Dominio = Direcci√≥n (nombre)", "Hosting = Nombre", "Dominio = Gratis"], a: 1, e: "Son servicios distintos pero complementarios." },
        { q: "Si falla el correo de recuperaci√≥n de contrase√±a, ¬øc√≥mo la cambias?", o: ["No se puede", "Editando el hash MD5 en la tabla wp_users de la base de datos", "Creando web nueva", "Llamando al hosting"], a: 1, e: "Acceso directo a la BD permite resetear credenciales." },
        { q: "¬øQu√© es un 'Shortcode'?", o: ["Error c√≥digo", "Etiqueta [ ] que ejecuta una funci√≥n din√°mica", "Contrase√±a", "Enlace permanente"], a: 1, e: "M√©todo de WP para incrustar elementos complejos." },
        { q: "¬øMejor pr√°ctica antes de una actualizaci√≥n mayor?", o: ["Actualizar directo", "Realizar copia de seguridad completa (Backup)", "No actualizar", "Solo plugins"], a: 1, e: "El backup es el √∫nico seguro ante incompatibilidades." },

        // --- BLOQUE 6: CONCEPTOS ADICIONALES DEL TEMARIO ---
        { q: "¬øQu√© es el 'Modo Mantenimiento'?", o: ["Error 404", "P√°gina temporal que oculta la web mientras se trabaja", "Fallo servidor", "Plugin"], a: 1, e: "Evita que los usuarios vean la web rota durante cambios." },
        { q: "Si la web carga descolocada (sin CSS), ¬øqu√© suele fallar?", o: ["Base de datos", "Rutas HTTPS incorrectas (Mixed Content) o permisos de carpetas", "Falta memoria", "Tema borrado"], a: 1, e: "El navegador bloquea los estilos si se sirven por HTTP en una web HTTPS." },
        { q: "¬øQu√© es un 'Iframe'?", o: ["Imagen", "Ventana para incrustar contenido externo (ej: YouTube/Maps)", "Plugin", "Error"], a: 1, e: "Etiqueta HTML est√°ndar para embeber recursos." },
        { q: "¬øQu√© es 'Gutenberg'?", o: ["Un tema", "El editor de bloques nativo de WordPress", "Plugin seguridad", "Hosting"], a: 1, e: "Sustituy√≥ al editor cl√°sico TinyMCE." },
        { q: "¬øPara qu√© sirve un 'Sidebar'?", o: ["Men√∫ principal", "√Årea lateral para widgets (buscadores, filtros)", "Pie p√°gina", "Imagen"], a: 1, e: "Zona cl√°sica de widgets en blogs y tiendas." },
        { q: "Diferencia 'Redirecci√≥n 301' vs '302':", o: ["Ninguna", "301 = Permanente (pasa SEO); 302 = Temporal", "301 = Error", "302 = R√°pida"], a: 1, e: "301 indica a Google que el cambio es definitivo." },
        { q: "¬øQu√© es el archivo 'functions.php'?", o: ["Configuraci√≥n", "Archivo del tema que act√∫a como plugin para a√±adir c√≥digo", "Base datos", "Estilo"], a: 1, e: "Permite extender la funcionalidad del tema activo." },
        { q: "¬øQu√© es 'MySQL'?", o: ["Dise√±o", "Sistema de gesti√≥n de base de datos usado por WordPress", "Servidor", "Plugin"], a: 1, e: "Almacena todo el contenido y configuraci√≥n." },
        { q: "Si el cron de WP falla, ¬øqu√© se recomienda?", o: ["Desactivarlo y usar cron real del servidor", "Borrarlo", "Plugin cron", "Nada"], a: 0, e: "El cron real es m√°s fiable y no depende de visitas." },
        { q: "¬øQu√© es una 'Landing Page'?", o: ["Blog", "P√°gina dise√±ada espec√≠ficamente para convertir (sin distracciones)", "Home", "Error"], a: 1, e: "Enfocada a un √∫nico objetivo (CTA)." }
    ];

    let questions = []; 
    let timer;
    let timeLeft = 45 * 60; 

    function init() {
        if(typeof DB === 'undefined') return alert("‚ö†Ô∏è ERROR: No has pegado las preguntas.");
        
        // Seleccionar 50 aleatorias
        questions = DB.sort(() => 0.5 - Math.random()).slice(0, 50);
        
        const container = document.getElementById('quiz-container');
        container.innerHTML = ""; 
        
        questions.forEach((q, index) => {
            // --- FIX: A√±adir comprobaci√≥n para evitar errores si una pregunta no tiene opciones ---
            if (!q.o || !Array.isArray(q.o)) {
                console.error(`Pregunta #${index} omitida por no tener opciones v√°lidas.`, q);
                return; // Saltar esta pregunta
            }
            // --- FIN DEL FIX ---

            let html = `
                <div class="card" id="card-${index}">
                    <div class="q-text"><span style="color:#2271b1; font-weight:800;">#${index + 1}</span> ${q.q}</div>
            `;
            
            // Barajar opciones visualmente
            let indices = q.o.map((_, i) => i);
            indices.sort(() => 0.5 - Math.random());

            html += `<div class="options-group">`;
            indices.forEach(i => {
                html += `
                    <label class="option-label" id="lbl-${index}-${i}">
                        <input type="radio" name="q_${index}" value="${i}">
                        ${q.o[i]}
                    </label>
                `;
            });

            html += `</div>
                     <div class="explanation-box" id="exp-${index}"></div>
                     </div>`;
            container.innerHTML += html;
        });

        startTimer();
        
        // Barra de progreso
        document.querySelectorAll('input').forEach(i => {
            i.addEventListener('change', () => {
                const answered = document.querySelectorAll('input:checked').length;
                document.getElementById('progress').style.width = `${(answered/50)*100}%`;
            });
        });
    }

    window.finishExam = function() {
        clearInterval(timer);
        
        let correctCount = 0;
        let reviewHTML = "";

        // Recorremos las 50 preguntas
        questions.forEach((q, index) => {
            const card = document.getElementById(`card-${index}`);
            const expBox = document.getElementById(`exp-${index}`);
            const selected = document.querySelector(`input[name="q_${index}"]:checked`);
            
            let userVal = selected ? parseInt(selected.value) : -1; 
            let isCorrect = (userVal === q.a);
            
            // Bloquear inputs
            card.querySelectorAll('input').forEach(i => i.disabled = true);

            // LOGICA VISUAL DETALLADA
            if (isCorrect) {
                correctCount++;
                card.classList.add('correct-card');
                document.getElementById(`lbl-${index}-${userVal}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚úÖ ¬°CORRECTO!</strong>${q.e}`;
                
                // Add to modal review
                reviewHTML += `<div class="review-item r-correct"><b>${index+1}. Acierto</b><br>Tu respuesta: ${q.o[userVal]}</div>`;
            
            } else if (userVal !== -1) {
                // Fall√≥
                card.classList.add('wrong-card');
                document.getElementById(`lbl-${index}-${userVal}`).classList.add('user-wrong');
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚ùå FALLO</strong><br>La correcta era: <b>${q.o[q.a]}</b><br><em>${q.e}</em>`;
                
                reviewHTML += `<div class="review-item r-wrong"><b>${index+1}. Fallo</b><br>Tu respuesta: ${q.o[userVal]}<br>Correcta: <strong>${q.o[q.a]}</strong></div>`;
            
            } else {
                // En blanco
                card.classList.add('wrong-card');
                document.getElementById(`lbl-${index}-${q.a}`).classList.add('correct-answer');
                expBox.innerHTML = `<strong>‚ö™ EN BLANCO</strong><br>La correcta era: <b>${q.o[q.a]}</b><br><em>${q.e}</em>`;
                
                reviewHTML += `<div class="review-item r-wrong"><b>${index+1}. En blanco</b><br>Correcta: <strong>${q.o[q.a]}</strong></div>`;
            }
            
            expBox.style.display = 'block';
        });

        // BAREMO CEI
        let verdict = "";
        let color = "";

        if (correctCount >= 45) { // 45-50
            verdict = "SOBRESALIENTE üèÜ";
            color = "#28a745";
        } else if (correctCount >= 40) { // 40-44
            verdict = "NOTABLE üåü";
            color = "#17a2b8";
        } else if (correctCount >= 35) { // 35-39
            verdict = "BIEN üëç";
            color = "#2271b1";
        } else if (correctCount >= 30) { // 30-34
            verdict = "APTO üëå";
            color = "#fd7e14";
        } else {
            verdict = "NO APTO ‚ùå";
            color = "#dc3545";
        }

        // PINTAR MODAL
        document.getElementById('score-display').innerText = `${correctCount} / 50`;
        document.getElementById('score-display').style.color = color;
        
        const vText = document.getElementById('verdict-text');
        vText.innerText = verdict;
        vText.style.color = color;

        document.getElementById('res-correct').innerText = correctCount;
        document.getElementById('res-wrong').innerText = 50 - correctCount;

        document.getElementById('detailed-review').innerHTML = reviewHTML;
        document.getElementById('result-modal').style.display = 'flex';
    };

    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            let m = Math.floor(timeLeft / 60);
            let s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if(timeLeft <= 0) finishExam();
        }, 1000);
    }

    window.onload = function() {
        if(typeof DB !== 'undefined') init();
    };

</script>
</body>
</html>