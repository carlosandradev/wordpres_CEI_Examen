<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Examen WP - Revisi√≥n Detallada2.0</title>
    <style>
        :root { --primary: #2271b1; --success: #28a745; --error: #dc3545; --bg: #f0f0f1; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: #3c434a; margin: 0; padding-bottom: 100px; }
        
        /* HEADER */
        .header { position: fixed; top: 0; left: 0; right: 0; background: #fff; border-bottom: 1px solid #c3c4c7; padding: 15px 20px; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .logo { font-weight: 800; color: var(--primary); font-size: 1.2rem; }
        .timer-box { font-variant-numeric: tabular-nums; font-size: 1.4rem; font-weight: 700; color: #1d2327; background: #f0f0f1; padding: 5px 15px; border-radius: 4px; }
        
        /* LAYOUT */
        .container { max-width: 800px; margin: 90px auto 20px; padding: 0 20px; }

        /* TARJETAS PREGUNTA */
        .card { background: #fff; border: 1px solid #c3c4c7; padding: 25px; margin-bottom: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
        .q-text { font-size: 1.15rem; font-weight: 600; margin-bottom: 20px; color: #1d2327; }
        
        /* OPCIONES */
        .option-label { display: flex; align-items: flex-start; gap: 12px; padding: 12px; border: 2px solid #f0f0f1; border-radius: 6px; cursor: pointer; transition: all 0.2s; margin-bottom: 10px; }
        .option-label:hover { background: #f6f7f7; border-color: var(--primary); }
        .option-label input { margin-top: 5px; transform: scale(1.3); cursor: pointer; accent-color: var(--primary); }
        
        /* BOT√ìN FINAL */
        .fab-finish { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #d63638; color: white; padding: 15px 40px; border-radius: 50px; border: none; font-size: 1.2rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(214, 54, 56, 0.4); z-index: 999; transition: transform 0.2s; white-space: nowrap; }
        .fab-finish:hover { transform: translateX(-50%) scale(1.05); background: #b32d2e; }

        /* MODAL RESULTADOS */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 800px; max-height: 90vh; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        
        .modal-header { padding: 20px; background: #f9f9f9; border-bottom: 1px solid #eee; text-align: center; }
        .score-big { font-size: 2.5rem; font-weight: 800; margin: 10px 0; color: var(--primary); }
        .verdict { font-size: 1.5rem; font-weight: 700; text-transform: uppercase; margin-bottom: 10px; }
        
        .modal-body { padding: 20px; overflow-y: auto; flex-grow: 1; text-align: left; background: #f0f0f1; }
        
        .btn-restart { background: var(--primary); color: white; border: none; padding: 15px; font-size: 1.1rem; cursor: pointer; width: 100%; font-weight: bold; }
        .btn-restart:hover { background: #135e96; }

        /* ESTILOS DE LA REVISI√ìN DETALLADA */
        .review-item { background: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 5px solid #ccc; font-size: 0.95rem; }
        .review-item.r-correct { border-left-color: var(--success); background: #f4fff7; }
        .review-item.r-wrong { border-left-color: var(--error); background: #fff5f5; }
        
        .r-question { font-weight: bold; margin-bottom: 10px; display: block; color: #333; }
        .r-user-ans { display: block; margin-bottom: 5px; }
        .r-correct-ans { display: block; margin-bottom: 5px; color: var(--success); font-weight: 600; }
        .r-explanation { display: block; margin-top: 10px; font-style: italic; color: #666; font-size: 0.9rem; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 5px; }

        .tag-correct { color: var(--success); font-weight: bold; }
        .tag-wrong { color: var(--error); font-weight: bold; text-decoration: line-through; }

        /* Progress Bar */
        .progress-container { position: fixed; top: 69px; left: 0; width: 100%; height: 4px; background: #e0e0e0; z-index: 998; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s; }
    </style>
</head>
<body>

    <div id="result-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin:0;">RESULTADO</h2>
                <div id="score-display" class="score-big">0 / 50</div>
                <div id="verdict-text" class="verdict">...</div>
                <div style="font-size:0.9rem; color:#666;">
                    ‚úÖ <span id="res-correct">0</span> | 
                    ‚ùå <span id="res-wrong">0</span>
                </div>
            </div>
            
            <div class="modal-body" id="detailed-review">
                </div>

            <button class="btn-restart" onclick="location.reload()">REPETIR EXAMEN (NUEVAS PREGUNTAS)</button>
        </div>
    </div>

    <header class="header">
        <div class="logo">EXAMEN WP</div>
        <div class="timer-box" id="timer">45:00</div>
    </header>
    <div class="progress-container"><div class="progress-bar" id="progress"></div></div>

    <div class="container" id="quiz-container"></div>

    <button class="fab-finish" onclick="finishExam()">FINALIZAR Y CALIFICAR</button>

<script>
    // ======================================================
    // ‚¨áÔ∏è ‚¨áÔ∏è PEGA AQU√ç TU VARIABLE const DB = [ ... ] ‚¨áÔ∏è ‚¨áÔ∏è
    // ======================================================
    
    // const DB = [ ... ];  <-- TU C√ìDIGO DE PREGUNTAS VA AQU√ç

    
    // ======================================================
    // L√ìGICA DEL EXAMEN
    // ======================================================

    let questions = []; 
    let timer;
    let timeLeft = 45 * 60; 

    // Inicializar
    function init() {
        if(typeof DB === 'undefined') return alert("‚ö†Ô∏è ERROR: No has pegado las preguntas en el c√≥digo.");
        
        // Coger 50 aleatorias
        questions = DB.sort(() => 0.5 - Math.random()).slice(0, 50);
        
        const container = document.getElementById('quiz-container');
        container.innerHTML = ""; 
        
        questions.forEach((q, index) => {
            let html = `
                <div class="card" id="card-${index}">
                    <div class="q-text"><span style="color:#2271b1">#${index + 1}</span> ${q.q}</div>
                    <div class="options-group">
            `;
            
            // Indices para opciones (0,1,2,3)
            let indices = q.o.map((_, i) => i);

            indices.forEach(i => {
                html += `
                    <label class="option-label">
                        <input type="radio" name="q_${index}" value="${i}">
                        ${q.o[i]}
                    </label>
                `;
            });

            html += `</div></div>`;
            container.innerHTML += html;
        });

        startTimer();
        
        // Barra de progreso
        document.querySelectorAll('input').forEach(i => {
            i.addEventListener('change', () => {
                const answered = document.querySelectorAll('input:checked').length;
                document.getElementById('progress').style.width = `${(answered/50)*100}%`;
            });
        });
    }

    // FINALIZAR Y MOSTRAR DETALLES
    window.finishExam = function() {
        clearInterval(timer);
        
        let correctCount = 0;
        let reviewHTML = "";

        // Recorremos las 50 preguntas
        questions.forEach((q, index) => {
            const selected = document.querySelector(`input[name="q_${index}"]:checked`);
            let userVal = selected ? parseInt(selected.value) : -1; // -1 si no respondi√≥
            let isCorrect = (userVal === q.a);
            
            if (isCorrect) correctCount++;

            // Generar HTML del reporte detallado
            let statusClass = isCorrect ? "r-correct" : "r-wrong";
            let icon = isCorrect ? "‚úÖ" : "‚ùå";
            
            // Texto de la respuesta del usuario
            let userText = (userVal !== -1) 
                ? `<span class="${isCorrect ? 'tag-correct' : 'tag-wrong'}">${q.o[userVal]}</span>` 
                : `<span style="color:#666; font-weight:bold;">(En blanco)</span>`;

            // HTML de cada bloque de revisi√≥n
            reviewHTML += `
                <div class="review-item ${statusClass}">
                    <span class="r-question">${index + 1}. ${q.q}</span>
                    <span class="r-user-ans">Tu respuesta: ${userText} ${icon}</span>
                    ${!isCorrect ? `<span class="r-correct-ans">Soluci√≥n: ${q.o[q.a]}</span>` : ''}
                    <span class="r-explanation">üí° ${q.e}</span>
                </div>
            `;
        });

        // CALCULAR NOTA Y BAREMO
        // Escala: 30-34 Apto, 35-39 Bien, 40-44 Notable, 45-50 Sobresaliente
        let verdict = "";
        let color = "";

        if (correctCount >= 45) {
            verdict = "SOBRESALIENTE üèÜ";
            color = "#28a745";
        } else if (correctCount >= 40) {
            verdict = "NOTABLE üåü";
            color = "#17a2b8";
        } else if (correctCount >= 35) {
            verdict = "BIEN üëç";
            color = "#2271b1";
        } else if (correctCount >= 30) {
            verdict = "APTO üëå";
            color = "#fd7e14"; // Naranja
        } else {
            verdict = "NO APTO ‚ùå";
            color = "#dc3545";
        }

        // PINTAR RESULTADOS
        document.getElementById('score-display').innerText = `${correctCount} / 50`;
        document.getElementById('score-display').style.color = color;
        
        const vText = document.getElementById('verdict-text');
        vText.innerText = verdict;
        vText.style.color = color;

        document.getElementById('res-correct').innerText = correctCount;
        document.getElementById('res-wrong').innerText = 50 - correctCount;

        // Insertar el reporte detallado
        document.getElementById('detailed-review').innerHTML = reviewHTML;

        // Mostrar Modal
        document.getElementById('result-modal').style.display = 'flex';
    };

    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            let m = Math.floor(timeLeft / 60);
            let s = timeLeft % 60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if(timeLeft <= 0) finishExam();
        }, 1000);
    }

    // Arrancar al cargar (si DB existe)
    window.onload = function() {
        if(typeof DB !== 'undefined') init();
    };

</script>
</body>
</html>

```